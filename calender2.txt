3:I[4707,[],""]
5:I[6423,[],""]
6:I[76,["185","static/chunks/app/layout-b51a0ad6cf0fab32.js"],"ThemeSwitcher"]
4:["slug","calender2","d"]
7:{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"}
8:{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"}
9:{"display":"inline-block"}
a:{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0}
0:["1AXbOSjeAIWogq940gTKm",[[["",{"children":["(blog)",{"children":[["slug","calender2","d"],{"children":["__PAGE__?{\"slug\":\"calender2\"}",{}]}]}]},"$undefined","$undefined",true],["",{"children":["(blog)",{"children":[["slug","calender2","d"],{"children":["__PAGE__",{},[["$L1","$L2",[["$","link","0",{"rel":"stylesheet","href":"/test/_next/static/css/f8ca774482f3c2cc.css","precedence":"next","crossOrigin":"$undefined"}]]],null],null]},[null,["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","(blog)","children","$4","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]],null]},[[[["$","link","0",{"rel":"stylesheet","href":"/test/_next/static/css/ce90c4206395b4a9.css","precedence":"next","crossOrigin":"$undefined"}]],["$","main",null,{"children":["$","div",null,{"className":"container px-8","children":["$","div",null,{"className":"lg:flex py-2","children":[["$","div",null,{"className":"sidebar overflow-x-visible lg:border-r lg:overflow-y-scroll py-4 min-w-80 lg:w-1/5","children":["$","nav",null,{"children":[["$","input",null,{"id":"ac-toc","type":"checkbox","className":"peer/toc hidden"}],["$","label",null,{"htmlFor":"ac-toc","className":"   accodiontoc mb-1   relative before:absolute after:absolute    z-10 after:z-11 before:z-12   peer-checked/toc:hover:after:-rotate-90   peer-checked/toc:bg-[#333]   peer-checked/toc:text-white   peer-checked/toc:before:bg-white   peer-checked/toc:after:bg-white   after:duration-300   py-2 pl-4 pr-10    text-xs font-bold   border border-solid rounded   border-white hover:border-[#bdc1c4]   inline-block   text-[#7a8288] hover:text-white   hover:bg-[#333]   before:content-[''] after:content-['']   before:w-2.5 before:h-0.5 after:w-0.5 after:h-2.5   before:right-4 before:top-4 after:right-5  after:top-3   before:bg-[#7a8288] after:bg-[#7a8288]   hover:after:bg-white hover:before:bg-white   lg:hidden   ","children":"メニュー"}],["$","div",null,{"className":"hidden lg:block peer-checked/toc:block mt-8 lg:mt-4","children":["$","section",null,{"children":[["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/test/helloworld","className":"hover:underline","children":"Hello, World!と表示させる"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/test/msgbox","className":"hover:underline","children":"MsgBox関数"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/test/inputbox","className":"hover:underline","children":"InputBox関数"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/test/array","className":"hover:underline","children":"配列(1) 配列の作り方"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/test/filter","className":"hover:underline","children":"配列(2) 配列の操作"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/test/rename","className":"hover:underline","children":"ファイル名の頭に日付を加える"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/test/fso","className":"hover:underline","children":"FileSystemObjectオブジェクト"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/test/path","className":"hover:underline","children":"ファイル名、パス名を取得する"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/test/file","className":"hover:underline","children":"File、Folder、Driveオブジェクト"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/test/filelist","className":"hover:underline","children":"ファイル一覧を取得する"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/test/textstream","className":"hover:underline","children":"TextStreamオブジェクト"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/test/mdb1","className":"hover:underline","children":"Access形式データベースへの接続（1）"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/test/mdb2","className":"hover:underline","children":"Access形式データベースへの接続（2）"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/test/stream","className":"hover:underline","children":"Streamオブジェクト"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/test/adox","className":"hover:underline","children":"ADOXの説明"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/test/mnist","className":"hover:underline","children":"バイナリファイルを読む"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/test/fldtype","className":"hover:underline","children":"ADOのデータ型"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/test/class","className":"hover:underline","children":"クラスを自作する"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/test/calender1","className":"hover:underline","children":"カレンダー計算(1) "}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/test/encoder","className":"hover:underline","children":"VBScriptの暗号化"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/test/calender2","className":"hover:underline","children":"カレンダー計算(2) "}]}]}]]}]}]]}]}],["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","(blog)","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":"404"}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],"notFoundStyles":[]}]]}]}]}]],null],null]},[[[["$","link","0",{"rel":"stylesheet","href":"/test/_next/static/css/8579c4287a58b810.css","precedence":"next","crossOrigin":"$undefined"}]],["$","html",null,{"lang":"en","children":[["$","head",null,{"children":[["$","link",null,{"rel":"apple-touch-icon","sizes":"180x180","href":"/test/favicon/apple-touch-icon.png"}],["$","link",null,{"rel":"icon","type":"image/png","sizes":"32x32","href":"/test/favicon/favicon-32x32.png"}],["$","link",null,{"rel":"icon","type":"image/png","sizes":"16x16","href":"/test/favicon/favicon-16x16.png"}],["$","link",null,{"rel":"manifest","href":"/test/favicon/site.webmanifest"}],["$","link",null,{"rel":"mask-icon","href":"/test/favicon/safari-pinned-tab.svg","color":"#000000"}],["$","link",null,{"rel":"shortcut icon","href":"/test/favicon/favicon.ico"}],["$","meta",null,{"name":"msapplication-TileColor","content":"#000000"}],["$","meta",null,{"name":"msapplication-config","content":"/test/favicon/browserconfig.xml"}],["$","meta",null,{"name":"theme-color","content":"#000"}],["$","link",null,{"rel":"alternate","type":"application/rss+xml","href":"/test/feed.xml"}]]}],["$","body",null,{"className":"__className_d8d0ad dark:bg-slate-900 dark:text-slate-400","children":[["$","$L6",null,{}],["$","header",null,{"className":"border-b border-neutral-200 dark:bg-stars","children":["$","div",null,{"className":"container px-8","children":["$","div",null,{"className":"py-16 flex flex-col lg:flex-row items-center","children":[["$","h2",null,{"className":"text-2xl lg:text-4xl font-bold tracking-tight lg:tracking-tighter leading-tight lg:w-1/3","children":[["$","a",null,{"href":"/test","className":"hover:underline","children":"VBScriptさんま屋"}],"."]}],["$","h4",null,{"className":"text-center text-lg","children":"VBScriptの個人的なメモです (´・ω・`)"}]]}]}]}],["$","div",null,{"className":"min-h-1/2","children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":"$7","children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":"$8","children":"404"}],["$","div",null,{"style":"$9","children":["$","h2",null,{"style":"$a","children":"This page could not be found."}]}]]}]}]],"notFoundStyles":[]}]}],["$","footer",null,{"className":"bg-neutral-50 border-t border-neutral-200 dark:bg-slate-800","children":["$","div",null,{"className":"container px-8","children":["$","div",null,{"className":"py-28 flex flex-col lg:flex-row items-center","children":[["$","h3",null,{"className":"text-4xl lg:text-[2.5rem] font-bold tracking-tighter leading-tight text-center lg:text-left mb-10 lg:mb-0 lg:pr-4 lg:w-1/2","children":"Statically Generated with Next.js."}],["$","div",null,{"className":"flex flex-col lg:flex-row justify-center items-center lg:pl-4 lg:w-1/2","children":[["$","a",null,{"href":"https://nextjs.org/docs/app/building-your-application/routing/layouts-and-templates","className":"mx-3 bg-black hover:bg-white hover:text-black border border-black text-white font-bold py-3 px-12 lg:px-8 duration-200 transition-colors mb-6 lg:mb-0","children":"Read Documentation"}],["$","a",null,{"href":"https://github.com/sammaya164/test","className":"mx-3 font-bold hover:underline","children":"View on GitHub"}]]}]]}]}]}]]}]]}]],null],null],["$Lb",null]]]]
c:T5641,<nav class="toc"><ol class="toc-level toc-level-1"><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#暦の計算">暦の計算</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#万年カレンダー">万年カレンダー</a></li></ol></nav><h2 id="暦の計算">暦の計算</h2>
<p>ユリウス日や修正ユリウス日は、天文計算のほか、暦の計算にも使えます。</p>
<ul>
<li>ユリウス暦、グレゴリオ暦の間で日付を変換したい場合:<br>
一旦修正ユリウス日に変換し、他方の日付へ変換します</li>
<li>曜日を知りたい場合:<br>
(修正ユリウス日+3)を7で割った余りから曜日を算出します(0:日、1:月、2:火、3:水、4:木、5:金、6:土)</li>
<li>日干支を知りたい場合:<br>
修正ユリウス日を10で割った余りから十干を算出(0:甲、1:乙、2:丙、3:丁、4:戊、5:己、6:庚、7:辛、8:壬、9:癸)<br>
(修正ユリウス日+2)を12で割った余りから十二支を算出(0:子、1丑、2:寅、3:卯、4:辰、5:巳、6:午、7:未、8:申、9:酉、10:戌、11:亥)<br>
2023年1月1日は5と7で己未(つちのとひつじ)</li>
</ul>
<h2 id="万年カレンダー">万年カレンダー</h2>
<p>カレンダーを表示するプログラムです。</p>
<p>1582年10月15日以降はグレゴリオ暦、それより前はユリウス暦で表示します。</p>
<pre><code class="hljs language-vbs"><span class="hljs-comment">'MJDや日付を指定すると、カレンダーを表示する</span>
<span class="hljs-keyword">Call</span> Main()



<span class="hljs-keyword">Function</span> Main()
    <span class="hljs-keyword">Dim</span> ret
    <span class="hljs-keyword">Dim</span> mjd
    <span class="hljs-keyword">Dim</span> dat
    <span class="hljs-keyword">Dim</span> msg(<span class="hljs-number">7</span>)

    msg(<span class="hljs-number">2</span>) = <span class="hljs-string">"ユリウス暦:"</span>
    msg(<span class="hljs-number">4</span>) = <span class="hljs-string">"グレゴリオ暦:"</span>
    ret = <span class="hljs-built_in">Date</span>()

    <span class="hljs-keyword">Do</span>  
        ret = <span class="hljs-built_in">InputBox</span>(<span class="hljs-string">"MJDまたは日付を入力してください。"</span>, <span class="hljs-string">"万年カレンダー"</span>, ret)
        <span class="hljs-keyword">If</span> ret = <span class="hljs-string">""</span> <span class="hljs-keyword">Then</span> <span class="hljs-keyword">Exit</span> <span class="hljs-keyword">Do</span>
        <span class="hljs-keyword">If</span> I<span class="hljs-built_in">sNumeric</span>(ret) <span class="hljs-keyword">Then</span>
            mjd    = <span class="hljs-built_in">CDbl</span>(ret)
            dat    = <span class="hljs-keyword">Get</span><span class="hljs-built_in">Date</span>(mjd) <span class="hljs-comment">'年月日の配列</span>
            msg(<span class="hljs-number">0</span>) = <span class="hljs-string">"MJD="</span> &#x26; mjd
            msg(<span class="hljs-number">3</span>) = <span class="hljs-keyword">To</span><span class="hljs-built_in">String</span>(Julian<span class="hljs-built_in">Date</span>(mjd))
            msg(<span class="hljs-number">5</span>) = <span class="hljs-keyword">To</span><span class="hljs-built_in">String</span>(Gregorian<span class="hljs-built_in">Date</span>(mjd))
            msg(<span class="hljs-number">7</span>) = GetCalender(dat(<span class="hljs-number">0</span>), dat(<span class="hljs-number">1</span>)) <span class="hljs-comment">'引数は年と月</span>
            Msgbox <span class="hljs-built_in">Join</span>(msg, vbCr),,<span class="hljs-string">"万年カレンダー"</span>  <span class="hljs-comment">'配列を改行でつなげて表示</span>
        
        <span class="hljs-keyword">ElseIf</span> <span class="hljs-built_in">UBound</span>(<span class="hljs-built_in">Split</span>(ret, <span class="hljs-string">"/"</span>)) = <span class="hljs-number">2</span> <span class="hljs-keyword">Then</span>
            dat    = <span class="hljs-built_in">Split</span>(ret, <span class="hljs-string">"/"</span>) <span class="hljs-comment">'年月日の配列</span>
            dat    = ToNumeric(dat)  <span class="hljs-comment">'配列要素を数値に変換</span>
            mjd    = GetMJD(dat(<span class="hljs-number">0</span>), dat(<span class="hljs-number">1</span>), dat(<span class="hljs-number">2</span>))
            msg(<span class="hljs-number">0</span>) = ret &#x26; <span class="hljs-string">" (MJD="</span> &#x26; mjd &#x26; <span class="hljs-string">")"</span>
            msg(<span class="hljs-number">3</span>) = <span class="hljs-keyword">To</span><span class="hljs-built_in">String</span>(Julian<span class="hljs-built_in">Date</span>(mjd))
            msg(<span class="hljs-number">5</span>) = <span class="hljs-keyword">To</span><span class="hljs-built_in">String</span>(Gregorian<span class="hljs-built_in">Date</span>(mjd))
            msg(<span class="hljs-number">7</span>) = GetCalender(dat(<span class="hljs-number">0</span>), dat(<span class="hljs-number">1</span>)) <span class="hljs-comment">'引数は年と月</span>
            Msgbox <span class="hljs-built_in">Join</span>(msg, vbCr),,<span class="hljs-string">"万年カレンダー"</span>  <span class="hljs-comment">'配列を改行でつなげて表示</span>
        <span class="hljs-keyword">Else</span>
            ret = <span class="hljs-built_in">Date</span>()
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    <span class="hljs-keyword">Loop</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>



<span class="hljs-comment">'修正ユリウス日を算出</span>
<span class="hljs-comment">'intCalender:暦を指定 (1:ユリウス暦, 2:グレゴリオ暦)</span>
<span class="hljs-keyword">Function</span> DateToMJD(<span class="hljs-keyword">ByVal</span> Y, <span class="hljs-keyword">ByVal</span> M, <span class="hljs-keyword">ByVal</span> D, intCalender)
    <span class="hljs-comment">'1,2月を前年の13,14月にする</span>
    <span class="hljs-keyword">If</span> M &#x3C; <span class="hljs-number">3</span> <span class="hljs-keyword">Then</span>
        Y = Y - <span class="hljs-number">1</span>
        M = M + <span class="hljs-number">12</span>
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    <span class="hljs-comment">'暦に応じて日付から修正ユリウス日を算出</span>
    <span class="hljs-keyword">Select</span> <span class="hljs-keyword">Case</span> intCalender
    <span class="hljs-keyword">Case</span> <span class="hljs-number">1</span>
        DateToMJD = - <span class="hljs-number">678884</span> + <span class="hljs-number">365</span> * Y + Month<span class="hljs-built_in">Day</span>(M - <span class="hljs-number">1</span>) + D + <span class="hljs-built_in">Int</span>(Y / <span class="hljs-number">4</span>)
    <span class="hljs-keyword">Case</span> <span class="hljs-number">2</span>
        DateToMJD = - <span class="hljs-number">678882</span> + <span class="hljs-number">365</span> * Y + Month<span class="hljs-built_in">Day</span>(M - <span class="hljs-number">1</span>) + D + <span class="hljs-built_in">Int</span>(Y / <span class="hljs-number">4</span>) - <span class="hljs-built_in">Int</span>(Y / <span class="hljs-number">100</span>) + <span class="hljs-built_in">Int</span>(Y / <span class="hljs-number">400</span>)
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">Select</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>



<span class="hljs-comment">'日付からユリウス暦かグレゴリオ暦かを判断してMJDを返す</span>
<span class="hljs-keyword">Function</span> GetMJD(y, m, d)
    <span class="hljs-keyword">If</span> <span class="hljs-number">10000</span>*y + <span class="hljs-number">100</span>*m + d &#x3C; <span class="hljs-number">15821015</span> <span class="hljs-keyword">Then</span>
        GetMJD = DateToMJD(y, m, d, <span class="hljs-number">1</span>)
    <span class="hljs-keyword">Else</span>
        GetMJD = DateToMJD(y, m, d, <span class="hljs-number">2</span>)
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>



<span class="hljs-comment">'MJDからユリウス暦の日付(配列)に変換して返す</span>
<span class="hljs-keyword">Function</span> Julian<span class="hljs-built_in">Date</span>(mjd)
    <span class="hljs-keyword">Dim</span> y, m, d

    <span class="hljs-comment">'MJDをユリウス暦の西暦0年(紀元前1年)2月29日を第0日とした日数へ変換</span>
    d = mjd - (<span class="hljs-number">-678884</span>)
    y = <span class="hljs-number">0</span>
    m = <span class="hljs-number">3</span>

    <span class="hljs-keyword">Dim</span> arr1, arr2, arr3

    <span class="hljs-comment">'年の計算</span>
    arr1 = <span class="hljs-built_in">Array</span>(<span class="hljs-number">1</span>,<span class="hljs-number">365</span>,<span class="hljs-number">1461</span>)
    arr2 = <span class="hljs-built_in">Array</span>(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">4</span>)
    arr3 = Div(d, arr1)
    y = y + Mult(arr2, arr3)
    d = arr3(<span class="hljs-number">0</span>)

    <span class="hljs-comment">'月の計算</span>
    <span class="hljs-comment">'2月末日の場合</span>
    <span class="hljs-keyword">If</span> d &#x3C; <span class="hljs-number">1</span> <span class="hljs-keyword">Then</span>
        m = <span class="hljs-number">2</span>
        <span class="hljs-keyword">If</span> arr3(<span class="hljs-number">1</span>) = <span class="hljs-number">0</span> <span class="hljs-keyword">Then</span>
            d = <span class="hljs-number">29</span> + d
        <span class="hljs-keyword">Else</span>
            d = <span class="hljs-number">28</span> + d
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    <span class="hljs-keyword">Else</span> <span class="hljs-comment">'2月末日以外の場合</span>
        <span class="hljs-keyword">Do</span> <span class="hljs-keyword">While</span> Month<span class="hljs-built_in">Day</span>(m) &#x3C; d
            m = m + <span class="hljs-number">1</span>
        <span class="hljs-keyword">Loop</span>
        d = d - Month<span class="hljs-built_in">Day</span>(m - <span class="hljs-number">1</span>)
        <span class="hljs-keyword">If</span> m > <span class="hljs-number">12</span> <span class="hljs-keyword">Then</span>
            y = y + <span class="hljs-number">1</span>
            m = m - <span class="hljs-number">12</span>
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    JulianDate =  <span class="hljs-built_in">Array</span>(y,m,<span class="hljs-built_in">Round</span>(d, <span class="hljs-number">5</span>)) <span class="hljs-comment">'日は小数点以下5桁まで</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>



<span class="hljs-comment">'MJDからグレゴリオ暦の日付(配列)に変換して返す</span>
<span class="hljs-keyword">Function</span> Gregorian<span class="hljs-built_in">Date</span>(mjd)
    <span class="hljs-keyword">Dim</span> y, m, d

    <span class="hljs-comment">'MJDをグレゴリオ暦の西暦0年(紀元前1年)2月29日を第0日とした日数へ変換</span>
    d = mjd - (<span class="hljs-number">-678882</span>)
    y = <span class="hljs-number">0</span>
    m = <span class="hljs-number">3</span>

    <span class="hljs-keyword">Dim</span> arr1, arr2, arr3

    <span class="hljs-comment">'年の計算</span>
    arr1 = <span class="hljs-built_in">Array</span>(<span class="hljs-number">1</span>,<span class="hljs-number">365</span>,<span class="hljs-number">1461</span>,<span class="hljs-number">36524</span>,<span class="hljs-number">146097</span>)
    arr2 = <span class="hljs-built_in">Array</span>(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">100</span>,<span class="hljs-number">400</span>)
    arr3 = Div(d, arr1)
    y = y + Mult(arr2, arr3)
    d = arr3(<span class="hljs-number">0</span>)

    <span class="hljs-comment">'月の計算</span>
    <span class="hljs-comment">'2月末日の場合</span>
    <span class="hljs-keyword">If</span> d &#x3C; <span class="hljs-number">1</span> <span class="hljs-keyword">Then</span>
        m = <span class="hljs-number">2</span>
        <span class="hljs-keyword">If</span> arr3(<span class="hljs-number">1</span>) = <span class="hljs-number">0</span> <span class="hljs-keyword">And</span> (arr3(<span class="hljs-number">2</span>) &#x3C;> <span class="hljs-number">0</span> <span class="hljs-keyword">Or</span> arr3(<span class="hljs-number">3</span>) = <span class="hljs-number">0</span>)  <span class="hljs-keyword">Then</span>
            d = <span class="hljs-number">29</span> + d
        <span class="hljs-keyword">Else</span>
            d = <span class="hljs-number">28</span> + d
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    <span class="hljs-keyword">Else</span> <span class="hljs-comment">'2月末日以外の場合</span>
        <span class="hljs-keyword">Do</span> <span class="hljs-keyword">While</span> Month<span class="hljs-built_in">Day</span>(m) &#x3C; d
            m = m + <span class="hljs-number">1</span>
        <span class="hljs-keyword">Loop</span>
        d = d - Month<span class="hljs-built_in">Day</span>(m - <span class="hljs-number">1</span>)
        <span class="hljs-keyword">If</span> m > <span class="hljs-number">12</span> <span class="hljs-keyword">Then</span>
            y = y + <span class="hljs-number">1</span>
            m = m - <span class="hljs-number">12</span>
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    GregorianDate =  <span class="hljs-built_in">Array</span>(y,m,<span class="hljs-built_in">Round</span>(d, <span class="hljs-number">5</span>)) <span class="hljs-comment">'日は小数点以下5桁まで</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>



<span class="hljs-comment">'MJDからユリウス暦かグレゴリオ暦かを判断して日付を返す</span>
<span class="hljs-keyword">Function</span> <span class="hljs-keyword">Get</span><span class="hljs-built_in">Date</span>(mjd)
    <span class="hljs-keyword">If</span> mjd >= <span class="hljs-number">-100840</span> <span class="hljs-keyword">Then</span>
        GetDate = Gregorian<span class="hljs-built_in">Date</span>(mjd) <span class="hljs-comment">'1582/10/15以降ならグレゴリオ暦の日付を返す</span>
    <span class="hljs-keyword">Else</span>
        GetDate = Julian<span class="hljs-built_in">Date</span>(mjd) <span class="hljs-comment">'それより前ならユリウス暦の日付を返す</span>
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>



<span class="hljs-comment">'例えばarr=[1,365,1461]の場合、a(0)+365*a(1)+1461*a(2)=valとなる配列aを返す</span>
<span class="hljs-keyword">Function</span> Div(val, arr)
    <span class="hljs-keyword">Dim</span> iMax
    <span class="hljs-keyword">Dim</span> buf
    <span class="hljs-keyword">Dim</span> i

    iMax = <span class="hljs-built_in">UBound</span>(arr)
    <span class="hljs-keyword">ReDim</span> buf(iMax)
    buf(<span class="hljs-number">0</span>) = val
    <span class="hljs-keyword">For</span> i = iMax <span class="hljs-keyword">To</span> <span class="hljs-number">1</span> <span class="hljs-keyword">Step</span> <span class="hljs-number">-1</span>
        buf(i) = <span class="hljs-built_in">Int</span>(buf(<span class="hljs-number">0</span>) / arr(i))     <span class="hljs-comment">'商の整数部</span>
        buf(<span class="hljs-number">0</span>) = buf(<span class="hljs-number">0</span>) - arr(i) * buf(i) <span class="hljs-comment">'余り(>0)</span>
    <span class="hljs-keyword">Next</span>
    Div = buf
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>



<span class="hljs-comment">'2つの配列の「内積」を返す</span>
<span class="hljs-keyword">Function</span> Mult(arr1, arr2)
    <span class="hljs-keyword">Dim</span> i

    <span class="hljs-keyword">For</span> i = <span class="hljs-number">0</span> <span class="hljs-keyword">To</span> <span class="hljs-built_in">UBound</span>(arr1)
        Mult = Mult + arr1(i) * arr2(i)
    <span class="hljs-keyword">Next</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>



<span class="hljs-comment">'2月末日を第0日としてM月末日までの日数を返す(M=2～13)</span>
<span class="hljs-keyword">Function</span> Month<span class="hljs-built_in">Day</span>(M)
  MonthDay = <span class="hljs-built_in">Int</span>(<span class="hljs-number">30.59</span> * (M - <span class="hljs-number">1</span>)) - <span class="hljs-number">30</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>



<span class="hljs-comment">'配列の要素を数値へ変換する</span>
<span class="hljs-keyword">Function</span> ToNumeric(<span class="hljs-keyword">ByVal</span> arr)
    <span class="hljs-keyword">Dim</span> i

    <span class="hljs-keyword">For</span> i = <span class="hljs-number">0</span> <span class="hljs-keyword">To</span> <span class="hljs-built_in">UBound</span>(arr)
        <span class="hljs-keyword">If</span> I<span class="hljs-built_in">sNumeric</span>(arr(i)) <span class="hljs-keyword">Then</span> <span class="hljs-comment">'数値として解釈できるなら</span>
            arr(i) = <span class="hljs-built_in">CDbl</span>(arr(i)) <span class="hljs-comment">'Double型へ変換</span>
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    <span class="hljs-keyword">Next</span>
    ToNumeric = arr
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>



<span class="hljs-comment">'日付の配列を文字列に変換する</span>
<span class="hljs-keyword">Function</span> <span class="hljs-keyword">To</span><span class="hljs-built_in">String</span>(dat)
    ToString = <span class="hljs-built_in">Join</span>(dat, <span class="hljs-string">"/"</span>)
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>



<span class="hljs-comment">'カレンダーを返す</span>
<span class="hljs-keyword">Function</span> GetCalender(y, m)
    <span class="hljs-keyword">Dim</span> mjd1, mjd2
    <span class="hljs-keyword">Dim</span> cale(<span class="hljs-number">5</span>, <span class="hljs-number">6</span>) <span class="hljs-comment">'カレンダーを表す配列</span>
    <span class="hljs-keyword">Dim</span> i <span class="hljs-comment">'週</span>
    <span class="hljs-keyword">Dim</span> j <span class="hljs-comment">'曜日: 0(日)～6(土)</span>
    <span class="hljs-keyword">Dim</span> buf

    mjd1 = GetMJD(y, m, <span class="hljs-number">1</span>)     <span class="hljs-comment">'当月1日の修正ユリウス日</span>
    mjd2 = GetMJD(y, m + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) <span class="hljs-comment">'翌月1日の修正ユリウス日</span>

    j = (mjd1 + <span class="hljs-number">3</span>) - <span class="hljs-built_in">Int</span>((mjd1 + <span class="hljs-number">3</span>) / <span class="hljs-number">7</span>) * <span class="hljs-number">7</span> <span class="hljs-comment">'当月1日の曜日</span>
    i = <span class="hljs-number">0</span> <span class="hljs-comment">'1週目</span>
    <span class="hljs-keyword">Do</span> <span class="hljs-keyword">While</span> mjd1 &#x3C; mjd2
        cale(i, j) = <span class="hljs-keyword">Get</span><span class="hljs-built_in">Date</span>(mjd1)(<span class="hljs-number">2</span>) <span class="hljs-comment">'日付</span>
        mjd1 = mjd1 + <span class="hljs-number">1</span>
        j = j + <span class="hljs-number">1</span>
        <span class="hljs-keyword">If</span> j > <span class="hljs-number">6</span> <span class="hljs-keyword">Then</span>
            j = <span class="hljs-number">0</span>
            i = i + <span class="hljs-number">1</span>
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    <span class="hljs-keyword">Loop</span>

    <span class="hljs-keyword">For</span> i = <span class="hljs-number">0</span> <span class="hljs-keyword">To</span> <span class="hljs-number">5</span>
        <span class="hljs-keyword">For</span> j = <span class="hljs-number">0</span> <span class="hljs-keyword">To</span> <span class="hljs-number">6</span>
            buf = buf &#x26; <span class="hljs-built_in">String</span>(<span class="hljs-number">4</span>-<span class="hljs-built_in">Len</span>(cale(i,j)), <span class="hljs-string">"_"</span>) &#x26; cale(i,j)
        <span class="hljs-keyword">Next</span>
        buf = buf &#x26; vbCr <span class="hljs-comment">'週ごとに改行</span>
    <span class="hljs-keyword">Next</span>

    buf = <span class="hljs-string">"Sun_Mon_Tue_Wed_Thu_Fri_Sat_"</span> &#x26; vbCrLf &#x26; buf
    buf = y &#x26; <span class="hljs-string">"年"</span> &#x26; m &#x26; <span class="hljs-string">"月"</span> &#x26; vbCrLf &#x26; buf

    <span class="hljs-comment">'結果を返す</span>
    GetCalender = buf

<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>
</code></pre>2:["$","article",null,{"className":"mb-32 pt-6 lg:px-6","children":[[["$","h1",null,{"className":"text-5xl md:text-7xl lg:text-8xl font-bold tracking-tighter leading-tight md:leading-none mb-12 text-left","children":"カレンダー計算(2) "}],["$","div",null,{"className":"mb-6 text-lg","children":["$","time",null,{"dateTime":"2024-10-31T00:00:00.000Z","children":"2024/10/31"}]}]],["$","div",null,{"className":"markdown-styles_markdown__ORfR8","dangerouslySetInnerHTML":{"__html":"$c"}}]]}]
b:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"カレンダー計算(2)  | VBScriptさんま屋"}],["$","meta","3",{"name":"description","content":"VBScriptの個人的なメモです"}],["$","meta","4",{"property":"og:title","content":"カレンダー計算(2) "}],["$","meta","5",{"property":"og:description","content":"VBScriptの個人的なメモです"}],["$","meta","6",{"property":"og:image","content":"https://www.sammaya.jp/test/assets/img/stars.jpg"}],["$","meta","7",{"name":"twitter:card","content":"summary_large_image"}],["$","meta","8",{"name":"twitter:title","content":"カレンダー計算(2) "}],["$","meta","9",{"name":"twitter:description","content":"VBScriptの個人的なメモです"}],["$","meta","10",{"name":"twitter:image","content":"https://www.sammaya.jp/test/assets/img/stars.jpg"}]]
1:null
