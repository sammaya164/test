<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/test/_next/static/css/8579c4287a58b810.css" data-precedence="next"/><link rel="stylesheet" href="/test/_next/static/css/ce90c4206395b4a9.css" data-precedence="next"/><link rel="stylesheet" href="/test/_next/static/css/f8ca774482f3c2cc.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/test/_next/static/chunks/webpack-62f207c7777ca9db.js"/><script src="/test/_next/static/chunks/fd9d1056-d9c6beefe29fb10d.js" async=""></script><script src="/test/_next/static/chunks/117-43fedde88f017f71.js" async=""></script><script src="/test/_next/static/chunks/main-app-0f3adf8e77f89c40.js" async=""></script><script src="/test/_next/static/chunks/app/layout-b51a0ad6cf0fab32.js" async=""></script><title>Access形式データベースへの接続（1） | VBScriptさんま屋</title><meta name="description" content="VBScriptの個人的なメモです"/><meta property="og:title" content="Access形式データベースへの接続（1）"/><meta property="og:description" content="VBScriptの個人的なメモです"/><meta property="og:image" content="https://www.sammaya.jp/test/assets/img/stars.jpg"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Access形式データベースへの接続（1）"/><meta name="twitter:description" content="VBScriptの個人的なメモです"/><meta name="twitter:image" content="https://www.sammaya.jp/test/assets/img/stars.jpg"/><link rel="apple-touch-icon" sizes="180x180" href="/test/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/test/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/test/favicon/favicon-16x16.png"/><link rel="manifest" href="/test/favicon/site.webmanifest"/><link rel="mask-icon" href="/test/favicon/safari-pinned-tab.svg" color="#000000"/><link rel="shortcut icon" href="/test/favicon/favicon.ico"/><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-config" content="/test/favicon/browserconfig.xml"/><meta name="theme-color" content="#000"/><link rel="alternate" type="application/rss+xml" href="/test/feed.xml"/><script src="/test/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__className_d8d0ad dark:bg-slate-900 dark:text-slate-400"><script>(e=>{let[t,n,r]=["system","dark","light"],i=()=>{let e=document.createElement("style");return e.textContent="*,*:after,*:before{transition:none !important;}",document.head.appendChild(e),()=>{getComputedStyle(document.body),setTimeout(()=>document.head.removeChild(e),1)}},a=matchMedia(`(prefers-color-scheme: ${n})`);window.updateDOM=()=>{let o=i(),l=localStorage.getItem(e)??t,s=a.matches?n:r,c=l===t?s:l,u=document.documentElement.classList;c===n?u.add(n):u.remove(n),document.documentElement.setAttribute("data-mode",l),o()},window.updateDOM(),a.addEventListener("change",window.updateDOM)})('nextjs-blog-starter-theme')</script><button class="switch_switch__v3CFJ"></button><header class="border-b border-neutral-200 dark:bg-stars"><div class="container px-8"><div class="py-16 flex flex-col lg:flex-row items-center"><h2 class="text-2xl lg:text-4xl font-bold tracking-tight lg:tracking-tighter leading-tight lg:w-1/3"><a href="/test" class="hover:underline">VBScriptさんま屋</a>.</h2><h4 class="text-center text-lg">VBScriptの個人的なメモです (´・ω・`)</h4></div></div></header><div class="min-h-1/2"><main><div class="container px-8"><div class="lg:flex py-2"><div class="sidebar overflow-x-visible lg:border-r lg:overflow-y-scroll py-4 min-w-80 lg:w-1/5"><nav><input id="ac-toc" type="checkbox" class="peer/toc hidden"/><label for="ac-toc" class="   accodiontoc mb-1   relative before:absolute after:absolute    z-10 after:z-11 before:z-12   peer-checked/toc:hover:after:-rotate-90   peer-checked/toc:bg-[#333]   peer-checked/toc:text-white   peer-checked/toc:before:bg-white   peer-checked/toc:after:bg-white   after:duration-300   py-2 pl-4 pr-10    text-xs font-bold   border border-solid rounded   border-white hover:border-[#bdc1c4]   inline-block   text-[#7a8288] hover:text-white   hover:bg-[#333]   before:content-[&#x27;&#x27;] after:content-[&#x27;&#x27;]   before:w-2.5 before:h-0.5 after:w-0.5 after:h-2.5   before:right-4 before:top-4 after:right-5  after:top-3   before:bg-[#7a8288] after:bg-[#7a8288]   hover:after:bg-white hover:before:bg-white   lg:hidden   ">メニュー</label><div class="hidden lg:block peer-checked/toc:block mt-8 lg:mt-4"><section><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/helloworld" class="hover:underline">Hello, World!と表示させる</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/msgbox" class="hover:underline">MsgBox関数</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/inputbox" class="hover:underline">InputBox関数</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/array" class="hover:underline">配列(1) 配列の作り方</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/filter" class="hover:underline">配列(2) 配列の操作</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/rename" class="hover:underline">ファイル名の頭に日付を加える</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/fso" class="hover:underline">FileSystemObjectオブジェクト</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/path" class="hover:underline">ファイル名、パス名を取得する</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/file" class="hover:underline">File、Folder、Driveオブジェクト</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/filelist" class="hover:underline">ファイル一覧を取得する</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/textstream" class="hover:underline">TextStreamオブジェクト</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/mdb1" class="hover:underline">Access形式データベースへの接続（1）</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/mdb2" class="hover:underline">Access形式データベースへの接続（2）</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/stream" class="hover:underline">Streamオブジェクト</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/adox" class="hover:underline">ADOXの説明</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/mnist" class="hover:underline">バイナリファイルを読む</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/fldtype" class="hover:underline">ADOのデータ型</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/class" class="hover:underline">クラスを自作する</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/calender1" class="hover:underline">カレンダー計算(1) </a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/encoder" class="hover:underline">VBScriptの暗号化</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/calender2" class="hover:underline">カレンダー計算(2) </a></h3></div></section></div></nav></div><article class="mb-32 pt-6 lg:px-6"><h1 class="text-5xl md:text-7xl lg:text-8xl font-bold tracking-tighter leading-tight md:leading-none mb-12 text-left">Access形式データベースへの接続（1）</h1><div class="mb-6 text-lg"><time dateTime="2024-10-31T00:00:00.000Z">2024/10/31</time></div><div class="markdown-styles_markdown__ORfR8"><nav class="toc"><ol class="toc-level toc-level-1"><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#概要">概要</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#oledbプロバイダーを確認する">OLEDBプロバイダーを確認する</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#mdbファイルを作成する">MDBファイルを作成する</a></li></ol></nav><h2 id="概要">概要</h2>
<h2 id="oledbプロバイダーを確認する">OLEDBプロバイダーを確認する</h2>
<p>VBScriptでデータベースへ接続するための事前準備として、利用可能なOLEDBプロバイダーを確認します。</p>
<p>PowerShellで以下のコマンドを実行します。</p>
<pre><code class="hljs language-shell">(New-Object data.oledb.oledbenumerator).getElements() | select SOURCES_NAME, SOURCES_DESCRIPTION
</code></pre>
<p>64bit版のOLEDBが表示されます。必要な行だけ示してます。</p>
<pre><code class="hljs language-shell">SOURCES_NAME               SOURCES_DESCRIPTION
------------               -------------------
Microsoft.ACE.OLEDB.12.0   Microsoft Office 12.0 Access Database Engine OLE DB Provider
Microsoft.ACE.OLEDB.16.0   Microsoft Office 16.0 Access Database Engine OLE DB Provider
</code></pre>
<p>つぎに32bit版PowerShellを起動して同じコマンドを実行します。</p>
<p><strong>ヒント:</strong> 32bit版PowerShellは C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe にあります。</p>
<p>32bit版のOLEDBが表示されます. 必要な行だけ示してます。</p>
<pre><code class="hljs language-shell">SOURCES_NAME               SOURCES_DESCRIPTION
------------               -------------------
Microsoft.Jet.OLEDB.4.0    Microsoft Jet 4.0 OLE DB Provider
</code></pre>
<p>以上から自分の環境では</p>
<ul>
<li>64bit版の<code>Microsoft.ACE.OLEDB.12.0</code></li>
<li>64bit版の<code>Microsoft.ACE.OLEDB.16.0</code></li>
<li>32bit版の<code>Microsoft.Jet.OLEDB.4.0</code></li>
</ul>
<p>が利用できることが分かります。</p>
<p>自分の環境は64bit版Officeをインストール済みなのでこのような構成になっているものと思われます。</p>
<p>VBScriptを動かしているWSHにも32bit版と64bit版があります。<br>
しかし、64bit版WSHからはデータベース接続に使うADODB.Connectionオブジェクトを使用できないようです。(VBAからは可能)</p>
<p>したがって、この環境でAccess形式データベースへ接続するには、32bit版WSHから <code>Microsoft.Jet.OLEDB.4.0</code> を利用することになります。</p>
<h2 id="mdbファイルを作成する">MDBファイルを作成する</h2>
<p>Accessがインストールされていなくても、VBScriptでMDBファイルを作成することができます。</p>
<pre><code class="hljs language-vbs"><span class="hljs-comment">'AccessのMDBファイルを作成する</span>

<span class="hljs-keyword">Option</span> <span class="hljs-keyword">Explicit</span>

<span class="hljs-keyword">Dim</span> con <span class="hljs-comment">'Connectionオブジェクト</span>
<span class="hljs-keyword">Dim</span> cat <span class="hljs-comment">'Catalogオブジェクト</span>
<span class="hljs-keyword">Dim</span> tbl <span class="hljs-comment">'Tableオブジェクト</span>
<span class="hljs-keyword">Dim</span> cols <span class="hljs-comment">'Columnsオブジェクト</span>

<span class="hljs-keyword">Set</span> con = <span class="hljs-built_in">CreateObject</span>(<span class="hljs-string">"ADODB.Connection"</span>)
<span class="hljs-keyword">Set</span> cat = <span class="hljs-built_in">CreateObject</span>(<span class="hljs-string">"ADOX.Catalog"</span>)
<span class="hljs-keyword">Set</span> tbl = <span class="hljs-built_in">CreateObject</span>(<span class="hljs-string">"ADOX.Table"</span>)

<span class="hljs-comment">'test.mdbを削除する</span>
<span class="hljs-comment">'call ClearTestFile("test.mdb") '必要に応じアンコメントする</span>

<span class="hljs-comment">'接続文字列</span>
con.ConnectionString = <span class="hljs-string">"Provider=Microsoft.JET.OLEDB.4.0;Data Source=test.mdb;"</span>

<span class="hljs-comment">'データベースを作成</span>
cat.Create con

<span class="hljs-comment">'テーブル名を設定</span>
tbl.Name = <span class="hljs-string">"data"</span>

<span class="hljs-comment">'テーブルを追加</span>
cat.Tables.Append tbl

<span class="hljs-comment">'dataテーブルが存在しているのを確認する</span>
Msgbox GetTableInfo(cat.Tables)

<span class="hljs-keyword">Set</span> cols = cat.Tables(<span class="hljs-string">"data"</span>).Columns

<span class="hljs-comment">'列を追加する</span>
cols.Append <span class="hljs-string">"短整数"</span>, <span class="hljs-number">2</span> <span class="hljs-comment">'VBScriptのInteger型に対応</span>
cols.Append <span class="hljs-string">"整数"</span>, <span class="hljs-number">3</span> <span class="hljs-comment">'VBScriptのLong型に対応</span>
cols.Append <span class="hljs-string">"テキスト"</span>, <span class="hljs-number">202</span>

<span class="hljs-comment">'列を削除する</span>
cols.Delete <span class="hljs-string">"短整数"</span>

<span class="hljs-comment">'列を確認する1</span>
Msgbox GetColInfo(cols)

<span class="hljs-comment">'列を確認する2</span>
Msgbox GetColInfo2(cols)


<span class="hljs-comment">'ファイルを削除する</span>
<span class="hljs-keyword">Function</span> ClearTestFile(fileName)
    <span class="hljs-keyword">Dim</span> fso
    
    <span class="hljs-keyword">Set</span> fso = <span class="hljs-built_in">CreateObject</span>(<span class="hljs-string">"Scripting.FileSystemObject"</span>)
    
    <span class="hljs-keyword">If</span> fso.FileExists(fileName) <span class="hljs-keyword">Then</span>
        fso.DeleteFile fileName
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>


<span class="hljs-comment">'Tablesコレクションに含まれるテーブルの名前とタイプを返す</span>
<span class="hljs-keyword">Function</span> GetTableInfo(tables)
    <span class="hljs-keyword">Dim</span> table
    <span class="hljs-keyword">Dim</span> buf

    <span class="hljs-keyword">For</span> <span class="hljs-keyword">Each</span> table <span class="hljs-keyword">In</span> tables
        buf = buf &#x26; table.Name &#x26; <span class="hljs-string">", "</span> &#x26; table.Type &#x26; vbCr 
    <span class="hljs-keyword">Next</span>

    GetTableInfo = buf
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>


<span class="hljs-comment">'Columnsコレクションに含まれる列の名前とタイプを返す(その1)</span>
<span class="hljs-keyword">Function</span> GetColInfo(cols)
    <span class="hljs-keyword">Dim</span> col
    <span class="hljs-keyword">Dim</span> buf

    <span class="hljs-keyword">For</span> <span class="hljs-keyword">Each</span> col <span class="hljs-keyword">In</span> cols
        buf = buf &#x26; col.Name &#x26; <span class="hljs-string">", タイプ: "</span> &#x26; col.Type &#x26; vbCr 
    <span class="hljs-keyword">Next</span>

    GetColInfo = buf
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>


<span class="hljs-comment">'Columnsコレクションに含まれる列の名前とタイプを返す(その2)</span>
<span class="hljs-keyword">Function</span> GetColInfo2(cols)
    <span class="hljs-keyword">Dim</span> i
    <span class="hljs-keyword">Dim</span> buf

    <span class="hljs-keyword">For</span> i = <span class="hljs-number">0</span> <span class="hljs-keyword">To</span> cols.Count - <span class="hljs-number">1</span>
        buf = buf &#x26; cols(i).Name &#x26; <span class="hljs-string">", タイプ: "</span> &#x26; cols(i).Type &#x26; vbCr 
    <span class="hljs-keyword">Next</span>

    GetColInfo2 = buf
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>
</code></pre>
<p>上記スクリプトファイルをWクリックすると64bit版WSHで実行されてエラーになります。(32bitのWindowsであればOK)</p>
<p>32bit版のWSHで実行するために、下記スクリプトファイルを作成し、これに上記スクリプトファイルをドラッグ&#x26;ドロップしてください。</p>
<p>スクリプトファイルはShift_JISの文字コードで保存してください。<br>
{: .notice--info}</p>
<pre><code class="hljs language-vbs"><span class="hljs-comment">'このスクリプトファイルにドラッグ&#x26;ドロップしたスクリプトファイルを32bit版のWSHで実行する</span>

<span class="hljs-keyword">Dim</span> shell <span class="hljs-comment">'WshShellオブジェクト</span>
<span class="hljs-keyword">Dim</span> fso   <span class="hljs-comment">'FileSystemObjectオブジェクト</span>
<span class="hljs-keyword">Dim</span> path

<span class="hljs-keyword">If</span> WScript.Arguments.Count = <span class="hljs-number">1</span> <span class="hljs-keyword">Then</span> <span class="hljs-comment">'1ファイルをドラッグ＆ドロップしたとき</span>
    <span class="hljs-keyword">Set</span> shell = <span class="hljs-built_in">CreateObject</span>(<span class="hljs-string">"WScript.Shell"</span>)
    <span class="hljs-keyword">Set</span> fso   = <span class="hljs-built_in">CreateObject</span>(<span class="hljs-string">"Scripting.FileSystemObject"</span>)

    <span class="hljs-comment">'ドラッグ＆ドロップしたスクリプトファイルのパス</span>
    path = WScript.Arguments(<span class="hljs-number">0</span>)

    <span class="hljs-comment">'作業フォルダとしてpathの親フォルダを指定</span>
    shell.CurrentDirectory = fso.GetParentFolderName(path)

    <span class="hljs-comment">'32bit版WSHでスクリプトを実行する</span>
    shell.Run <span class="hljs-string">"C:\windows\SysWOW64\wscript.exe """</span> &#x26; path &#x26; <span class="hljs-string">""""</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
</code></pre>
<p><strong>解説:</strong> WshShellオブジェクトのRunメソッドを使うことにより、コマンドプロンプトで実行した場合と同じ効果が得られます。<br>
{: .notice}</p>
<p><strong>解説:</strong> 空白を含むパスにも対応するためpathを""で囲んでます。<br>
{: .notice}</p>
<p>スクリプトファイルと同じフォルダ内にtest.mdbが作成されたと思います。</p></div></article></div></div></main></div><footer class="bg-neutral-50 border-t border-neutral-200 dark:bg-slate-800"><div class="container px-8"><div class="py-28 flex flex-col lg:flex-row items-center"><h3 class="text-4xl lg:text-[2.5rem] font-bold tracking-tighter leading-tight text-center lg:text-left mb-10 lg:mb-0 lg:pr-4 lg:w-1/2">Statically Generated with Next.js.</h3><div class="flex flex-col lg:flex-row justify-center items-center lg:pl-4 lg:w-1/2"><a href="https://nextjs.org/docs/app/building-your-application/routing/layouts-and-templates" class="mx-3 bg-black hover:bg-white hover:text-black border border-black text-white font-bold py-3 px-12 lg:px-8 duration-200 transition-colors mb-6 lg:mb-0">Read Documentation</a><a href="https://github.com/sammaya164/test" class="mx-3 font-bold hover:underline">View on GitHub</a></div></div></div></footer><script src="/test/_next/static/chunks/webpack-62f207c7777ca9db.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/test/_next/static/css/8579c4287a58b810.css\",\"style\"]\n2:HL[\"/test/_next/static/css/ce90c4206395b4a9.css\",\"style\"]\n3:HL[\"/test/_next/static/css/f8ca774482f3c2cc.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"4:I[2846,[],\"\"]\n7:I[4707,[],\"\"]\n9:I[6423,[],\"\"]\na:I[76,[\"185\",\"static/chunks/app/layout-b51a0ad6cf0fab32.js\"],\"ThemeSwitcher\"]\n10:I[1060,[],\"\"]\n8:[\"slug\",\"mdb1\",\"d\"]\nb:{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"}\nc:{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"}\nd:{\"display\":\"inline-block\"}\ne:{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0}\n11:[]\n"])</script><script>self.__next_f.push([1,"0:[\"$\",\"$L4\",null,{\"buildId\":\"1AXbOSjeAIWogq940gTKm\",\"assetPrefix\":\"/test\",\"urlParts\":[\"\",\"mdb1\"],\"initialTree\":[\"\",{\"children\":[\"(blog)\",{\"children\":[[\"slug\",\"mdb1\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"mdb1\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"(blog)\",{\"children\":[[\"slug\",\"mdb1\",\"d\"],{\"children\":[\"__PAGE__\",{},[[\"$L5\",\"$L6\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/test/_next/static/css/f8ca774482f3c2cc.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]]],null],null]},[null,[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(blog)\",\"children\",\"$8\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/test/_next/static/css/ce90c4206395b4a9.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"main\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"container px-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"lg:flex py-2\",\"children\":[[\"$\",\"div\",null,{\"className\":\"sidebar overflow-x-visible lg:border-r lg:overflow-y-scroll py-4 min-w-80 lg:w-1/5\",\"children\":[\"$\",\"nav\",null,{\"children\":[[\"$\",\"input\",null,{\"id\":\"ac-toc\",\"type\":\"checkbox\",\"className\":\"peer/toc hidden\"}],[\"$\",\"label\",null,{\"htmlFor\":\"ac-toc\",\"className\":\"   accodiontoc mb-1   relative before:absolute after:absolute    z-10 after:z-11 before:z-12   peer-checked/toc:hover:after:-rotate-90   peer-checked/toc:bg-[#333]   peer-checked/toc:text-white   peer-checked/toc:before:bg-white   peer-checked/toc:after:bg-white   after:duration-300   py-2 pl-4 pr-10    text-xs font-bold   border border-solid rounded   border-white hover:border-[#bdc1c4]   inline-block   text-[#7a8288] hover:text-white   hover:bg-[#333]   before:content-[''] after:content-['']   before:w-2.5 before:h-0.5 after:w-0.5 after:h-2.5   before:right-4 before:top-4 after:right-5  after:top-3   before:bg-[#7a8288] after:bg-[#7a8288]   hover:after:bg-white hover:before:bg-white   lg:hidden   \",\"children\":\"メニュー\"}],[\"$\",\"div\",null,{\"className\":\"hidden lg:block peer-checked/toc:block mt-8 lg:mt-4\",\"children\":[\"$\",\"section\",null,{\"children\":[[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/helloworld\",\"className\":\"hover:underline\",\"children\":\"Hello, World!と表示させる\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/msgbox\",\"className\":\"hover:underline\",\"children\":\"MsgBox関数\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/inputbox\",\"className\":\"hover:underline\",\"children\":\"InputBox関数\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/array\",\"className\":\"hover:underline\",\"children\":\"配列(1) 配列の作り方\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/filter\",\"className\":\"hover:underline\",\"children\":\"配列(2) 配列の操作\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/rename\",\"className\":\"hover:underline\",\"children\":\"ファイル名の頭に日付を加える\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/fso\",\"className\":\"hover:underline\",\"children\":\"FileSystemObjectオブジェクト\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/path\",\"className\":\"hover:underline\",\"children\":\"ファイル名、パス名を取得する\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/file\",\"className\":\"hover:underline\",\"children\":\"File、Folder、Driveオブジェクト\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/filelist\",\"className\":\"hover:underline\",\"children\":\"ファイル一覧を取得する\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/textstream\",\"className\":\"hover:underline\",\"children\":\"TextStreamオブジェクト\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/mdb1\",\"className\":\"hover:underline\",\"children\":\"Access形式データベースへの接続（1）\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/mdb2\",\"className\":\"hover:underline\",\"children\":\"Access形式データベースへの接続（2）\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/stream\",\"className\":\"hover:underline\",\"children\":\"Streamオブジェクト\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/adox\",\"className\":\"hover:underline\",\"children\":\"ADOXの説明\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/mnist\",\"className\":\"hover:underline\",\"children\":\"バイナリファイルを読む\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/fldtype\",\"className\":\"hover:underline\",\"children\":\"ADOのデータ型\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/class\",\"className\":\"hover:underline\",\"children\":\"クラスを自作する\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/calender1\",\"className\":\"hover:underline\",\"children\":\"カレンダー計算(1) \"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/encoder\",\"className\":\"hover:underline\",\"children\":\"VBScriptの暗号化\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/calender2\",\"className\":\"hover:underline\",\"children\":\"カレンダー計算(2) \"}]}]}]]}]}]]}]}],[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(blog)\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[]}]]}]}]}]],null],null]},[[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/test/_next/static/css/8579c4287a58b810.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"apple-touch-icon\",\"sizes\":\"180x180\",\"href\":\"/test/favicon/apple-touch-icon.png\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"sizes\":\"32x32\",\"href\":\"/test/favicon/favicon-32x32.png\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"sizes\":\"16x16\",\"href\":\"/test/favicon/favicon-16x16.png\"}],[\"$\",\"link\",null,{\"rel\":\"manifest\",\"href\":\"/test/favicon/site.webmanifest\"}],[\"$\",\"link\",null,{\"rel\":\"mask-icon\",\"href\":\"/test/favicon/safari-pinned-tab.svg\",\"color\":\"#000000\"}],[\"$\",\"link\",null,{\"rel\":\"shortcut icon\",\"href\":\"/test/favicon/favicon.ico\"}],[\"$\",\"meta\",null,{\"name\":\"msapplication-TileColor\",\"content\":\"#000000\"}],[\"$\",\"meta\",null,{\"name\":\"msapplication-config\",\"content\":\"/test/favicon/browserconfig.xml\"}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"content\":\"#000\"}],[\"$\",\"link\",null,{\"rel\":\"alternate\",\"type\":\"application/rss+xml\",\"href\":\"/test/feed.xml\"}]]}],[\"$\",\"body\",null,{\"className\":\"__className_d8d0ad dark:bg-slate-900 dark:text-slate-400\",\"children\":[[\"$\",\"$La\",null,{}],[\"$\",\"header\",null,{\"className\":\"border-b border-neutral-200 dark:bg-stars\",\"children\":[\"$\",\"div\",null,{\"className\":\"container px-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"py-16 flex flex-col lg:flex-row items-center\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"text-2xl lg:text-4xl font-bold tracking-tight lg:tracking-tighter leading-tight lg:w-1/3\",\"children\":[[\"$\",\"a\",null,{\"href\":\"/test\",\"className\":\"hover:underline\",\"children\":\"VBScriptさんま屋\"}],\".\"]}],[\"$\",\"h4\",null,{\"className\":\"text-center text-lg\",\"children\":\"VBScriptの個人的なメモです (´・ω・`)\"}]]}]}]}],[\"$\",\"div\",null,{\"className\":\"min-h-1/2\",\"children\":[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":\"$b\",\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":\"$c\",\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":\"$d\",\"children\":[\"$\",\"h2\",null,{\"style\":\"$e\",\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[]}]}],[\"$\",\"footer\",null,{\"className\":\"bg-neutral-50 border-t border-neutral-200 dark:bg-slate-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"container px-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"py-28 flex flex-col lg:flex-row items-center\",\"children\":[[\"$\",\"h3\",null,{\"className\":\"text-4xl lg:text-[2.5rem] font-bold tracking-tighter leading-tight text-center lg:text-left mb-10 lg:mb-0 lg:pr-4 lg:w-1/2\",\"children\":\"Statically Generated with Next.js.\"}],[\"$\",\"div\",null,{\"className\":\"flex flex-col lg:flex-row justify-center items-center lg:pl-4 lg:w-1/2\",\"children\":[[\"$\",\"a\",null,{\"href\":\"https://nextjs.org/docs/app/building-your-application/routing/layouts-and-templates\",\"className\":\"mx-3 bg-black hover:bg-white hover:text-black border border-black text-white font-bold py-3 px-12 lg:px-8 duration-200 transition-colors mb-6 lg:mb-0\",\"children\":\"Read Documentation\"}],[\"$\",\"a\",null,{\"href\":\"https://github.com/sammaya164/test\",\"className\":\"mx-3 font-bold hover:underline\",\"children\":\"View on GitHub\"}]]}]]}]}]}]]}]]}]],null],null],\"couldBeIntercepted\":false,\"initialHead\":[null,\"$Lf\"],\"globalErrorComponent\":\"$10\",\"missingSlots\":\"$W11\"}]\n"])</script><script>self.__next_f.push([1,"12:T2a8e,"])</script><script>self.__next_f.push([1,"\u003cnav class=\"toc\"\u003e\u003col class=\"toc-level toc-level-1\"\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#概要\"\u003e概要\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#oledbプロバイダーを確認する\"\u003eOLEDBプロバイダーを確認する\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#mdbファイルを作成する\"\u003eMDBファイルを作成する\u003c/a\u003e\u003c/li\u003e\u003c/ol\u003e\u003c/nav\u003e\u003ch2 id=\"概要\"\u003e概要\u003c/h2\u003e\n\u003ch2 id=\"oledbプロバイダーを確認する\"\u003eOLEDBプロバイダーを確認する\u003c/h2\u003e\n\u003cp\u003eVBScriptでデータベースへ接続するための事前準備として、利用可能なOLEDBプロバイダーを確認します。\u003c/p\u003e\n\u003cp\u003ePowerShellで以下のコマンドを実行します。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-shell\"\u003e(New-Object data.oledb.oledbenumerator).getElements() | select SOURCES_NAME, SOURCES_DESCRIPTION\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e64bit版のOLEDBが表示されます。必要な行だけ示してます。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-shell\"\u003eSOURCES_NAME               SOURCES_DESCRIPTION\r\n------------               -------------------\r\nMicrosoft.ACE.OLEDB.12.0   Microsoft Office 12.0 Access Database Engine OLE DB Provider\r\nMicrosoft.ACE.OLEDB.16.0   Microsoft Office 16.0 Access Database Engine OLE DB Provider\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eつぎに32bit版PowerShellを起動して同じコマンドを実行します。\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eヒント:\u003c/strong\u003e 32bit版PowerShellは C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe にあります。\u003c/p\u003e\n\u003cp\u003e32bit版のOLEDBが表示されます. 必要な行だけ示してます。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-shell\"\u003eSOURCES_NAME               SOURCES_DESCRIPTION\r\n------------               -------------------\r\nMicrosoft.Jet.OLEDB.4.0    Microsoft Jet 4.0 OLE DB Provider\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e以上から自分の環境では\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e64bit版の\u003ccode\u003eMicrosoft.ACE.OLEDB.12.0\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e64bit版の\u003ccode\u003eMicrosoft.ACE.OLEDB.16.0\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e32bit版の\u003ccode\u003eMicrosoft.Jet.OLEDB.4.0\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eが利用できることが分かります。\u003c/p\u003e\n\u003cp\u003e自分の環境は64bit版Officeをインストール済みなのでこのような構成になっているものと思われます。\u003c/p\u003e\n\u003cp\u003eVBScriptを動かしているWSHにも32bit版と64bit版があります。\u003cbr\u003e\nしかし、64bit版WSHからはデータベース接続に使うADODB.Connectionオブジェクトを使用できないようです。(VBAからは可能)\u003c/p\u003e\n\u003cp\u003eしたがって、この環境でAccess形式データベースへ接続するには、32bit版WSHから \u003ccode\u003eMicrosoft.Jet.OLEDB.4.0\u003c/code\u003e を利用することになります。\u003c/p\u003e\n\u003ch2 id=\"mdbファイルを作成する\"\u003eMDBファイルを作成する\u003c/h2\u003e\n\u003cp\u003eAccessがインストールされていなくても、VBScriptでMDBファイルを作成することができます。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-vbs\"\u003e\u003cspan class=\"hljs-comment\"\u003e'AccessのMDBファイルを作成する\u003c/span\u003e\r\n\r\n\u003cspan class=\"hljs-keyword\"\u003eOption\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eExplicit\u003c/span\u003e\r\n\r\n\u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e con \u003cspan class=\"hljs-comment\"\u003e'Connectionオブジェクト\u003c/span\u003e\r\n\u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e cat \u003cspan class=\"hljs-comment\"\u003e'Catalogオブジェクト\u003c/span\u003e\r\n\u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e tbl \u003cspan class=\"hljs-comment\"\u003e'Tableオブジェクト\u003c/span\u003e\r\n\u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e cols \u003cspan class=\"hljs-comment\"\u003e'Columnsオブジェクト\u003c/span\u003e\r\n\r\n\u003cspan class=\"hljs-keyword\"\u003eSet\u003c/span\u003e con = \u003cspan class=\"hljs-built_in\"\u003eCreateObject\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"ADODB.Connection\"\u003c/span\u003e)\r\n\u003cspan class=\"hljs-keyword\"\u003eSet\u003c/span\u003e cat = \u003cspan class=\"hljs-built_in\"\u003eCreateObject\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"ADOX.Catalog\"\u003c/span\u003e)\r\n\u003cspan class=\"hljs-keyword\"\u003eSet\u003c/span\u003e tbl = \u003cspan class=\"hljs-built_in\"\u003eCreateObject\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"ADOX.Table\"\u003c/span\u003e)\r\n\r\n\u003cspan class=\"hljs-comment\"\u003e'test.mdbを削除する\u003c/span\u003e\r\n\u003cspan class=\"hljs-comment\"\u003e'call ClearTestFile(\"test.mdb\") '必要に応じアンコメントする\u003c/span\u003e\r\n\r\n\u003cspan class=\"hljs-comment\"\u003e'接続文字列\u003c/span\u003e\r\ncon.ConnectionString = \u003cspan class=\"hljs-string\"\u003e\"Provider=Microsoft.JET.OLEDB.4.0;Data Source=test.mdb;\"\u003c/span\u003e\r\n\r\n\u003cspan class=\"hljs-comment\"\u003e'データベースを作成\u003c/span\u003e\r\ncat.Create con\r\n\r\n\u003cspan class=\"hljs-comment\"\u003e'テーブル名を設定\u003c/span\u003e\r\ntbl.Name = \u003cspan class=\"hljs-string\"\u003e\"data\"\u003c/span\u003e\r\n\r\n\u003cspan class=\"hljs-comment\"\u003e'テーブルを追加\u003c/span\u003e\r\ncat.Tables.Append tbl\r\n\r\n\u003cspan class=\"hljs-comment\"\u003e'dataテーブルが存在しているのを確認する\u003c/span\u003e\r\nMsgbox GetTableInfo(cat.Tables)\r\n\r\n\u003cspan class=\"hljs-keyword\"\u003eSet\u003c/span\u003e cols = cat.Tables(\u003cspan class=\"hljs-string\"\u003e\"data\"\u003c/span\u003e).Columns\r\n\r\n\u003cspan class=\"hljs-comment\"\u003e'列を追加する\u003c/span\u003e\r\ncols.Append \u003cspan class=\"hljs-string\"\u003e\"短整数\"\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e'VBScriptのInteger型に対応\u003c/span\u003e\r\ncols.Append \u003cspan class=\"hljs-string\"\u003e\"整数\"\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e'VBScriptのLong型に対応\u003c/span\u003e\r\ncols.Append \u003cspan class=\"hljs-string\"\u003e\"テキスト\"\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e\r\n\r\n\u003cspan class=\"hljs-comment\"\u003e'列を削除する\u003c/span\u003e\r\ncols.Delete \u003cspan class=\"hljs-string\"\u003e\"短整数\"\u003c/span\u003e\r\n\r\n\u003cspan class=\"hljs-comment\"\u003e'列を確認する1\u003c/span\u003e\r\nMsgbox GetColInfo(cols)\r\n\r\n\u003cspan class=\"hljs-comment\"\u003e'列を確認する2\u003c/span\u003e\r\nMsgbox GetColInfo2(cols)\r\n\r\n\r\n\u003cspan class=\"hljs-comment\"\u003e'ファイルを削除する\u003c/span\u003e\r\n\u003cspan class=\"hljs-keyword\"\u003eFunction\u003c/span\u003e ClearTestFile(fileName)\r\n    \u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e fso\r\n    \r\n    \u003cspan class=\"hljs-keyword\"\u003eSet\u003c/span\u003e fso = \u003cspan class=\"hljs-built_in\"\u003eCreateObject\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Scripting.FileSystemObject\"\u003c/span\u003e)\r\n    \r\n    \u003cspan class=\"hljs-keyword\"\u003eIf\u003c/span\u003e fso.FileExists(fileName) \u003cspan class=\"hljs-keyword\"\u003eThen\u003c/span\u003e\r\n        fso.DeleteFile fileName\r\n    \u003cspan class=\"hljs-keyword\"\u003eEnd\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eIf\u003c/span\u003e\r\n\u003cspan class=\"hljs-keyword\"\u003eEnd\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eFunction\u003c/span\u003e\r\n\r\n\r\n\u003cspan class=\"hljs-comment\"\u003e'Tablesコレクションに含まれるテーブルの名前とタイプを返す\u003c/span\u003e\r\n\u003cspan class=\"hljs-keyword\"\u003eFunction\u003c/span\u003e GetTableInfo(tables)\r\n    \u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e table\r\n    \u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e buf\r\n\r\n    \u003cspan class=\"hljs-keyword\"\u003eFor\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eEach\u003c/span\u003e table \u003cspan class=\"hljs-keyword\"\u003eIn\u003c/span\u003e tables\r\n        buf = buf \u0026#x26; table.Name \u0026#x26; \u003cspan class=\"hljs-string\"\u003e\", \"\u003c/span\u003e \u0026#x26; table.Type \u0026#x26; vbCr \r\n    \u003cspan class=\"hljs-keyword\"\u003eNext\u003c/span\u003e\r\n\r\n    GetTableInfo = buf\r\n\u003cspan class=\"hljs-keyword\"\u003eEnd\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eFunction\u003c/span\u003e\r\n\r\n\r\n\u003cspan class=\"hljs-comment\"\u003e'Columnsコレクションに含まれる列の名前とタイプを返す(その1)\u003c/span\u003e\r\n\u003cspan class=\"hljs-keyword\"\u003eFunction\u003c/span\u003e GetColInfo(cols)\r\n    \u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e col\r\n    \u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e buf\r\n\r\n    \u003cspan class=\"hljs-keyword\"\u003eFor\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eEach\u003c/span\u003e col \u003cspan class=\"hljs-keyword\"\u003eIn\u003c/span\u003e cols\r\n        buf = buf \u0026#x26; col.Name \u0026#x26; \u003cspan class=\"hljs-string\"\u003e\", タイプ: \"\u003c/span\u003e \u0026#x26; col.Type \u0026#x26; vbCr \r\n    \u003cspan class=\"hljs-keyword\"\u003eNext\u003c/span\u003e\r\n\r\n    GetColInfo = buf\r\n\u003cspan class=\"hljs-keyword\"\u003eEnd\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eFunction\u003c/span\u003e\r\n\r\n\r\n\u003cspan class=\"hljs-comment\"\u003e'Columnsコレクションに含まれる列の名前とタイプを返す(その2)\u003c/span\u003e\r\n\u003cspan class=\"hljs-keyword\"\u003eFunction\u003c/span\u003e GetColInfo2(cols)\r\n    \u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e i\r\n    \u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e buf\r\n\r\n    \u003cspan class=\"hljs-keyword\"\u003eFor\u003c/span\u003e i = \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eTo\u003c/span\u003e cols.Count - \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\r\n        buf = buf \u0026#x26; cols(i).Name \u0026#x26; \u003cspan class=\"hljs-string\"\u003e\", タイプ: \"\u003c/span\u003e \u0026#x26; cols(i).Type \u0026#x26; vbCr \r\n    \u003cspan class=\"hljs-keyword\"\u003eNext\u003c/span\u003e\r\n\r\n    GetColInfo2 = buf\r\n\u003cspan class=\"hljs-keyword\"\u003eEnd\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eFunction\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e上記スクリプトファイルをWクリックすると64bit版WSHで実行されてエラーになります。(32bitのWindowsであればOK)\u003c/p\u003e\n\u003cp\u003e32bit版のWSHで実行するために、下記スクリプトファイルを作成し、これに上記スクリプトファイルをドラッグ\u0026#x26;ドロップしてください。\u003c/p\u003e\n\u003cp\u003eスクリプトファイルはShift_JISの文字コードで保存してください。\u003cbr\u003e\n{: .notice--info}\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-vbs\"\u003e\u003cspan class=\"hljs-comment\"\u003e'このスクリプトファイルにドラッグ\u0026#x26;ドロップしたスクリプトファイルを32bit版のWSHで実行する\u003c/span\u003e\r\n\r\n\u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e shell \u003cspan class=\"hljs-comment\"\u003e'WshShellオブジェクト\u003c/span\u003e\r\n\u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e fso   \u003cspan class=\"hljs-comment\"\u003e'FileSystemObjectオブジェクト\u003c/span\u003e\r\n\u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e path\r\n\r\n\u003cspan class=\"hljs-keyword\"\u003eIf\u003c/span\u003e WScript.Arguments.Count = \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eThen\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e'1ファイルをドラッグ＆ドロップしたとき\u003c/span\u003e\r\n    \u003cspan class=\"hljs-keyword\"\u003eSet\u003c/span\u003e shell = \u003cspan class=\"hljs-built_in\"\u003eCreateObject\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"WScript.Shell\"\u003c/span\u003e)\r\n    \u003cspan class=\"hljs-keyword\"\u003eSet\u003c/span\u003e fso   = \u003cspan class=\"hljs-built_in\"\u003eCreateObject\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Scripting.FileSystemObject\"\u003c/span\u003e)\r\n\r\n    \u003cspan class=\"hljs-comment\"\u003e'ドラッグ＆ドロップしたスクリプトファイルのパス\u003c/span\u003e\r\n    path = WScript.Arguments(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\r\n\r\n    \u003cspan class=\"hljs-comment\"\u003e'作業フォルダとしてpathの親フォルダを指定\u003c/span\u003e\r\n    shell.CurrentDirectory = fso.GetParentFolderName(path)\r\n\r\n    \u003cspan class=\"hljs-comment\"\u003e'32bit版WSHでスクリプトを実行する\u003c/span\u003e\r\n    shell.Run \u003cspan class=\"hljs-string\"\u003e\"C:\\windows\\SysWOW64\\wscript.exe \"\"\"\u003c/span\u003e \u0026#x26; path \u0026#x26; \u003cspan class=\"hljs-string\"\u003e\"\"\"\"\u003c/span\u003e\r\n\u003cspan class=\"hljs-keyword\"\u003eEnd\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eIf\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003e解説:\u003c/strong\u003e WshShellオブジェクトのRunメソッドを使うことにより、コマンドプロンプトで実行した場合と同じ効果が得られます。\u003cbr\u003e\n{: .notice}\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e解説:\u003c/strong\u003e 空白を含むパスにも対応するためpathを\"\"で囲んでます。\u003cbr\u003e\n{: .notice}\u003c/p\u003e\n\u003cp\u003eスクリプトファイルと同じフォルダ内にtest.mdbが作成されたと思います。\u003c/p\u003e"])</script><script>self.__next_f.push([1,"6:[\"$\",\"article\",null,{\"className\":\"mb-32 pt-6 lg:px-6\",\"children\":[[[\"$\",\"h1\",null,{\"className\":\"text-5xl md:text-7xl lg:text-8xl font-bold tracking-tighter leading-tight md:leading-none mb-12 text-left\",\"children\":\"Access形式データベースへの接続（1）\"}],[\"$\",\"div\",null,{\"className\":\"mb-6 text-lg\",\"children\":[\"$\",\"time\",null,{\"dateTime\":\"2024-10-31T00:00:00.000Z\",\"children\":\"2024/10/31\"}]}]],[\"$\",\"div\",null,{\"className\":\"markdown-styles_markdown__ORfR8\",\"dangerouslySetInnerHTML\":{\"__html\":\"$12\"}}]]}]\nf:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Access形式データベースへの接続（1） | VBScriptさんま屋\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"VBScriptの個人的なメモです\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:title\",\"content\":\"Access形式データベースへの接続（1）\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:description\",\"content\":\"VBScriptの個人的なメモです\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:image\",\"content\":\"https://www.sammaya.jp/test/assets/img/stars.jpg\"}],[\"$\",\"meta\",\"7\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"8\",{\"name\":\"twitter:title\",\"content\":\"Access形式データベースへの接続（1）\"}],[\"$\",\"meta\",\"9\",{\"name\":\"twitter:description\",\"content\":\"VBScriptの個人的なメモです\"}],[\"$\",\"meta\",\"10\",{\"name\":\"twitter:image\",\"content\":\"https://www.sammaya.jp/test/assets/img/stars.jpg\"}]]\n5:null\n"])</script></body></html>