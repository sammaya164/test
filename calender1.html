<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/test/_next/static/css/8579c4287a58b810.css" data-precedence="next"/><link rel="stylesheet" href="/test/_next/static/css/ce90c4206395b4a9.css" data-precedence="next"/><link rel="stylesheet" href="/test/_next/static/css/f8ca774482f3c2cc.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/test/_next/static/chunks/webpack-62f207c7777ca9db.js"/><script src="/test/_next/static/chunks/fd9d1056-d9c6beefe29fb10d.js" async=""></script><script src="/test/_next/static/chunks/117-43fedde88f017f71.js" async=""></script><script src="/test/_next/static/chunks/main-app-0f3adf8e77f89c40.js" async=""></script><script src="/test/_next/static/chunks/app/layout-b51a0ad6cf0fab32.js" async=""></script><title>カレンダー計算(1)  | VBScriptさんま屋</title><meta name="description" content="VBScriptの個人的なメモです"/><meta property="og:title" content="カレンダー計算(1) "/><meta property="og:description" content="VBScriptの個人的なメモです"/><meta property="og:image" content="https://www.sammaya.jp/test/assets/img/stars.jpg"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="カレンダー計算(1) "/><meta name="twitter:description" content="VBScriptの個人的なメモです"/><meta name="twitter:image" content="https://www.sammaya.jp/test/assets/img/stars.jpg"/><link rel="apple-touch-icon" sizes="180x180" href="/test/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/test/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/test/favicon/favicon-16x16.png"/><link rel="manifest" href="/test/favicon/site.webmanifest"/><link rel="mask-icon" href="/test/favicon/safari-pinned-tab.svg" color="#000000"/><link rel="shortcut icon" href="/test/favicon/favicon.ico"/><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-config" content="/test/favicon/browserconfig.xml"/><meta name="theme-color" content="#000"/><link rel="alternate" type="application/rss+xml" href="/test/feed.xml"/><script src="/test/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__className_d8d0ad dark:bg-slate-900 dark:text-slate-400"><script>(e=>{let[t,n,r]=["system","dark","light"],i=()=>{let e=document.createElement("style");return e.textContent="*,*:after,*:before{transition:none !important;}",document.head.appendChild(e),()=>{getComputedStyle(document.body),setTimeout(()=>document.head.removeChild(e),1)}},a=matchMedia(`(prefers-color-scheme: ${n})`);window.updateDOM=()=>{let o=i(),l=localStorage.getItem(e)??t,s=a.matches?n:r,c=l===t?s:l,u=document.documentElement.classList;c===n?u.add(n):u.remove(n),document.documentElement.setAttribute("data-mode",l),o()},window.updateDOM(),a.addEventListener("change",window.updateDOM)})('nextjs-blog-starter-theme')</script><button class="switch_switch__v3CFJ"></button><header class="border-b border-neutral-200 dark:bg-stars"><div class="container px-8"><div class="py-16 flex flex-col lg:flex-row items-center"><h2 class="text-2xl lg:text-4xl font-bold tracking-tight lg:tracking-tighter leading-tight lg:w-1/3"><a href="/test" class="hover:underline">VBScriptさんま屋</a>.</h2><h4 class="text-center text-lg">VBScriptの個人的なメモです (´・ω・`)</h4></div></div></header><div class="min-h-1/2"><main><div class="container px-8"><div class="lg:flex py-2"><div class="sidebar overflow-x-visible lg:border-r lg:overflow-y-scroll py-4 min-w-80 lg:w-1/5"><nav><input id="ac-toc" type="checkbox" class="peer/toc hidden"/><label for="ac-toc" class="   accodiontoc mb-1   relative before:absolute after:absolute    z-10 after:z-11 before:z-12   peer-checked/toc:hover:after:-rotate-90   peer-checked/toc:bg-[#333]   peer-checked/toc:text-white   peer-checked/toc:before:bg-white   peer-checked/toc:after:bg-white   after:duration-300   py-2 pl-4 pr-10    text-xs font-bold   border border-solid rounded   border-white hover:border-[#bdc1c4]   inline-block   text-[#7a8288] hover:text-white   hover:bg-[#333]   before:content-[&#x27;&#x27;] after:content-[&#x27;&#x27;]   before:w-2.5 before:h-0.5 after:w-0.5 after:h-2.5   before:right-4 before:top-4 after:right-5  after:top-3   before:bg-[#7a8288] after:bg-[#7a8288]   hover:after:bg-white hover:before:bg-white   lg:hidden   ">メニュー</label><div class="hidden lg:block peer-checked/toc:block mt-8 lg:mt-4"><section><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/helloworld" class="hover:underline">Hello, World!と表示させる</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/msgbox" class="hover:underline">MsgBox関数</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/inputbox" class="hover:underline">InputBox関数</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/array" class="hover:underline">配列(1) 配列の作り方</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/filter" class="hover:underline">配列(2) 配列の操作</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/rename" class="hover:underline">ファイル名の頭に日付を加える</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/fso" class="hover:underline">FileSystemObjectオブジェクト</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/path" class="hover:underline">ファイル名、パス名を取得する</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/file" class="hover:underline">File、Folder、Driveオブジェクト</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/filelist" class="hover:underline">ファイル一覧を取得する</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/textstream" class="hover:underline">TextStreamオブジェクト</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/mdb1" class="hover:underline">Access形式データベースへの接続（1）</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/mdb2" class="hover:underline">Access形式データベースへの接続（2）</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/stream" class="hover:underline">Streamオブジェクト</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/adox" class="hover:underline">ADOXの説明</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/mnist" class="hover:underline">バイナリファイルを読む</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/fldtype" class="hover:underline">ADOのデータ型</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/class" class="hover:underline">クラスを自作する</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/calender1" class="hover:underline">カレンダー計算(1) </a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/encoder" class="hover:underline">VBScriptの暗号化</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/test/calender2" class="hover:underline">カレンダー計算(2) </a></h3></div></section></div></nav></div><article class="mb-32 pt-6 lg:px-6"><h1 class="text-5xl md:text-7xl lg:text-8xl font-bold tracking-tighter leading-tight md:leading-none mb-12 text-left">カレンダー計算(1) </h1><div class="mb-6 text-lg"><time dateTime="2024-10-31T00:00:00.000Z">2024/10/31</time></div><div class="markdown-styles_markdown__ORfR8"><nav class="toc"><ol class="toc-level toc-level-1"><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#日付を日数で表す">日付を日数で表す</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#西暦">西暦</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#ユリウス日修正ユリウス日を計算する">ユリウス日、修正ユリウス日を計算する</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#修正ユリウス日から日付へ変換する">修正ユリウス日から日付へ変換する</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#参考">参考</a></li></ol></nav><h2 id="日付を日数で表す">日付を日数で表す</h2>
<p>年月日で表される日付は、いわば年・月・日の3つの軸をもつ空間に並べられた<br>
点の集まりと解釈できます。<br>
しかし天文計算においては、日付は1本の線上に並べたほうが扱い易くなります。<br>
すなわち、ある特定の日を第0日としたときの通算の日数で日付を表すという方法です。</p>
<h3 id="ユリウス日julian-day">ユリウス日(Julian Day)</h3>
<ul>
<li>ユリウス日(ユリウス通日、JD)は、紀元前4713年1月1日正午(ユリウス暦)を第0日としたときの通算の日数で日付を表したものです。</li>
<li>正負の整数であれば正午を表しますが、小数部で時刻を表します。</li>
</ul>
<p>2023年1月1日の正午で、2,459,946になります。<br>
{: .notice--info}</p>
<h3 id="修正ユリウス日modified-julian-day">修正ユリウス日(Modified Julian Day)</h3>
<ul>
<li>修正ユリウス日(準ユリウス日、MJD)は、ユリウス日よりも小さい桁で日付を扱えるよう考え出され、ユリウス日から2400000.5日を引いたものとして定義されます。</li>
<li>1858年11月17日(グレゴリオ暦)を第0日としたときの通算の日数で日付を表します。</li>
<li>正負の整数であれば午前0時を表しますが、小数部で時刻を表します。</li>
</ul>
<p>2023年1月1日の午前0時で59,945になります。<br>
{: .notice--info}</p>
<h2 id="西暦">西暦</h2>
<p>西暦には、うるう年をどのように定めるかによって、ユリウス暦とグレゴリオ暦があります。<br>
現在使われているのはグレゴリオ暦です。</p>
<h3 id="ユリウス暦">ユリウス暦</h3>
<p>以下のルールがあります。</p>
<ol>
<li>うるう年は4年に1回。</li>
</ol>
<p>すなわち4年は正確に1,461日(=365×3+366)、1年あたりは365.25日(=1,461/4)。</p>
<p>実際の1太陽年はおよそ365.2422日なので「春分、夏至、秋分、冬至」といった季節の移り変わりに対し、<br>
1年あたり-0.0078日(=365.2422-365.25)の誤差が生じます。1600年経てば約12.5日のズレになります。</p>
<p>ユリウス暦は紀元前45年にローマで導入されましたが、当初は4年に1回とすべきうるう年を、3年に1回で誤運用してしまいました。<br>
誤りに気づいた後、調整の為うるう年を設けない期間が設けられ、西暦8年のうるう年以降は4年に1回で運用されました。<br>
以下のプログラムにおけるユリウス暦の計算では、このへんの歴史は考慮せず、単純に4年に1回うるう年を設けています。<br>
{: .notice--info}</p>
<h3 id="グレゴリオ暦">グレゴリオ暦</h3>
<p>以下のルールがあります。</p>
<ol>
<li>うるう年は4年に1回</li>
<li>ただし100年に1回(西暦が100で割り切れる年)はうるう年を取消し。</li>
<li>ただし400年に1回(西暦が400で割り切れる年)はやっぱりうるう年。</li>
</ol>
<p>すなわち400年は正確に146,097日(=365×303+366×97)、1年あたりは365.2425日(=146,097/400)。</p>
<p>期間の選び方によって、4年は1,460日の場合と1,461日の場合があり、100年は36,524日の場合と36,525日の場合があります。<br>
{: .notice--info}</p>
<p>グレゴリオ暦は、ユリウス暦1582年10月4日の翌日、グレゴリオ暦1582年10月15日からローマで採用されました。<br>
グレゴリオ暦の導入時期は国によって異なり、日本では旧暦明治5年12月2日の翌日、新暦明治6年1月1日から開始されました。</p>
<p>季節の移り変わりに対し、1年あたり約+0.0003日の誤差が生じます。<br>
1万年経っても約3日のズレしかない計算になります。</p>
<p>なお地球の自転や公転のスピードは徐々に変動している為、それらの比である1太陽年の日数も変動します。<br>
1万年後のズレは3日より小さいかも知れないし、大きいかも知れません。<br>
{: .notice--info}</p>
<h3 id="紀元前の表現">紀元前の表現</h3>
<p>西暦1年の前年は紀元前1年ですが、天文学では年数計算を簡便にする為、紀元前1年を西暦0年、<br>
紀元前2年を西暦-1年、・・、紀元前N年を西暦-(N-1)年とする紀年法が使われるそうです。<br>
以下のプログラムもこれに従います。たとえば紀元前4713年は西暦-4712年になります。</p>
<h2 id="ユリウス日修正ユリウス日を計算する">ユリウス日、修正ユリウス日を計算する</h2>
<p>年月日からユリウス日、修正ユリウス日を算出して表示するプログラムです。重要なのは<code>DateToMJD</code>関数の箇所です。</p>
<pre><code class="hljs language-vbs"><span class="hljs-comment">'ユリウス日、修正ユリウス日を計算する</span>
<span class="hljs-keyword">Dim</span> ret
<span class="hljs-keyword">Dim</span> dt <span class="hljs-comment">'年月日を表す配列</span>
<span class="hljs-keyword">Dim</span> buf(<span class="hljs-number">6</span>)
<span class="hljs-keyword">Dim</span> mjd

<span class="hljs-keyword">Do</span>
    ret = <span class="hljs-built_in">InputBox</span>(<span class="hljs-string">"日付を入力して下さい"</span>, , <span class="hljs-built_in">Date</span>())
    <span class="hljs-keyword">If</span> ret = <span class="hljs-string">""</span> <span class="hljs-keyword">Then</span> <span class="hljs-keyword">Exit</span> <span class="hljs-keyword">Do</span>
    dt = <span class="hljs-built_in">Split</span>(ret, <span class="hljs-string">"/"</span>) <span class="hljs-comment">'Splitで取得した配列要素は文字列</span>
    dt = ToNumeric(dt)   <span class="hljs-comment">'配列要素を数値へ変換</span>

    mjd = DateToMJD(dt(<span class="hljs-number">0</span>), dt(<span class="hljs-number">1</span>), dt(<span class="hljs-number">2</span>), <span class="hljs-number">1</span>)
    buf(<span class="hljs-number">0</span>) = <span class="hljs-string">"ユリウス暦の"</span> &#x26; ret &#x26; <span class="hljs-string">"は"</span>
    buf(<span class="hljs-number">1</span>) = <span class="hljs-string">"JD="</span> &#x26; mjd + <span class="hljs-number">2400000.5</span>
    buf(<span class="hljs-number">2</span>) = <span class="hljs-string">"MJD="</span> &#x26; mjd

    mjd = DateToMJD(dt(<span class="hljs-number">0</span>), dt(<span class="hljs-number">1</span>), dt(<span class="hljs-number">2</span>), <span class="hljs-number">2</span>)
    buf(<span class="hljs-number">4</span>) = <span class="hljs-string">"グレゴリオ暦の"</span> &#x26; ret &#x26; <span class="hljs-string">"は"</span>
    buf(<span class="hljs-number">5</span>) = <span class="hljs-string">"JD="</span> &#x26; mjd + <span class="hljs-number">2400000.5</span>
    buf(<span class="hljs-number">6</span>) = <span class="hljs-string">"MJD="</span> &#x26; mjd

    Msgbox <span class="hljs-built_in">Join</span>(buf, vbCr),, <span class="hljs-string">"ユリウス日計算"</span> <span class="hljs-comment">'配列をCR改行でつなげて表示</span>
<span class="hljs-keyword">Loop</span>



<span class="hljs-comment">'配列の要素を数値へ変換する</span>
<span class="hljs-keyword">Function</span> ToNumeric(<span class="hljs-keyword">ByVal</span> arr)
    <span class="hljs-keyword">Dim</span> i

    <span class="hljs-keyword">For</span> i = <span class="hljs-number">0</span> <span class="hljs-keyword">To</span> <span class="hljs-built_in">UBound</span>(arr)
        <span class="hljs-keyword">If</span> I<span class="hljs-built_in">sNumeric</span>(arr(i)) <span class="hljs-keyword">Then</span> <span class="hljs-comment">'数値として解釈できるなら</span>
            arr(i) = <span class="hljs-built_in">CDbl</span>(arr(i)) <span class="hljs-comment">'Double型へ変換</span>
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    <span class="hljs-keyword">Next</span>
    ToNumeric = arr
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>



<span class="hljs-comment">'修正ユリウス日を算出</span>
<span class="hljs-comment">'intCalender:暦を指定 (1:ユリウス暦, 2:グレゴリオ暦)</span>
<span class="hljs-keyword">Function</span> DateToMJD(<span class="hljs-keyword">ByVal</span> Y, <span class="hljs-keyword">ByVal</span> M, <span class="hljs-keyword">ByVal</span> D, intCalender)
    <span class="hljs-comment">'1,2月を前年の13,14月にする</span>
    <span class="hljs-keyword">If</span> M &#x3C; <span class="hljs-number">3</span> <span class="hljs-keyword">Then</span>
        Y = Y - <span class="hljs-number">1</span>
        M = M + <span class="hljs-number">12</span>
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    <span class="hljs-comment">'暦に応じて日付から修正ユリウス日を算出</span>
    <span class="hljs-keyword">Select</span> <span class="hljs-keyword">Case</span> intCalender
    <span class="hljs-keyword">Case</span> <span class="hljs-number">1</span>
        DateToMJD = - <span class="hljs-number">678884</span> + <span class="hljs-number">365</span> * Y + Month<span class="hljs-built_in">Day</span>(M - <span class="hljs-number">1</span>) + D + <span class="hljs-built_in">Int</span>(Y / <span class="hljs-number">4</span>)
    <span class="hljs-keyword">Case</span> <span class="hljs-number">2</span>
        DateToMJD = - <span class="hljs-number">678882</span> + <span class="hljs-number">365</span> * Y + Month<span class="hljs-built_in">Day</span>(M - <span class="hljs-number">1</span>) + D + <span class="hljs-built_in">Int</span>(Y / <span class="hljs-number">4</span>) - <span class="hljs-built_in">Int</span>(Y / <span class="hljs-number">100</span>) + <span class="hljs-built_in">Int</span>(Y / <span class="hljs-number">400</span>)
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">Select</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>



<span class="hljs-comment">' 2月末日を第0日としてM月末日までの日数を返す(M=2～13)</span>
<span class="hljs-keyword">Function</span> Month<span class="hljs-built_in">Day</span>(M)
    MonthDay = <span class="hljs-built_in">Int</span>(<span class="hljs-number">30.59</span> * (M - <span class="hljs-number">1</span>)) - <span class="hljs-number">30</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>
</code></pre>
<p><strong>ByVal:</strong> VBScriptでは引数はデフォルトで参照渡しですが、ByValをつけることで値渡しになります。</p>
<p>1,2月を13,14月に変換するのは、計算上2月末日を1年の最終日、もしくは翌年の第0日として扱うためです。</p>
<p>MJDの計算式に出てくる-678884と-678882は、それぞれユリウス暦とグレゴリオ暦における紀元前1年2月29日のMJDです。</p>
<p>上記のMonthDay関数の引数と戻り値は次表のようになります。</p>
<p>|引数|2|3|4|5|6|7|8|9|10|11|12|13|<br>
|---|---|---|---|---|---|---|<br>
|戻り値|0|31|61|92|122|153|184|214|245|275|306|337|</p>
<p>次のように書いたほうが、何をやっているかはわかりやすいかも知れません。</p>
<pre><code class="hljs language-vbs"><span class="hljs-comment">' 2月末日を第0日としてM月末日までの日数を返す(M=2～13)</span>
<span class="hljs-keyword">Function</span> Month<span class="hljs-built_in">Day</span>(M)
    <span class="hljs-keyword">Dim</span> days(<span class="hljs-number">13</span>)
    <span class="hljs-keyword">Dim</span> i
    
    days(<span class="hljs-number">3</span>)  = <span class="hljs-number">31</span>
    days(<span class="hljs-number">4</span>)  = <span class="hljs-number">30</span>
    days(<span class="hljs-number">5</span>)  = <span class="hljs-number">31</span>
    days(<span class="hljs-number">6</span>)  = <span class="hljs-number">30</span>
    days(<span class="hljs-number">7</span>)  = <span class="hljs-number">31</span>
    days(<span class="hljs-number">8</span>)  = <span class="hljs-number">31</span>
    days(<span class="hljs-number">9</span>)  = <span class="hljs-number">30</span>
    days(<span class="hljs-number">10</span>) = <span class="hljs-number">31</span>
    days(<span class="hljs-number">11</span>) = <span class="hljs-number">30</span>
    days(<span class="hljs-number">12</span>) = <span class="hljs-number">31</span>
    days(<span class="hljs-number">13</span>) = <span class="hljs-number">31</span>
    
    <span class="hljs-keyword">For</span> i = <span class="hljs-number">3</span> <span class="hljs-keyword">To</span> M
        MonthDay = MonthDay + days(i)
    <span class="hljs-keyword">Next</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>
</code></pre>
<h2 id="修正ユリウス日から日付へ変換する">修正ユリウス日から日付へ変換する</h2>
<p>日付への変換は、その逆より難しいです。</p>
<pre><code class="hljs language-vbs"><span class="hljs-comment">'MJDから日付へ変換して表示する</span>

<span class="hljs-keyword">Dim</span> ret
<span class="hljs-keyword">Dim</span> msg(<span class="hljs-number">4</span>)
msg(<span class="hljs-number">1</span>) = <span class="hljs-string">"ユリウス暦:"</span>
msg(<span class="hljs-number">3</span>) = <span class="hljs-string">"グレゴリオ暦:"</span>

<span class="hljs-keyword">Do</span>
    ret = <span class="hljs-built_in">InputBox</span>(<span class="hljs-string">"MJDを入力してください。"</span>)
    <span class="hljs-keyword">If</span> ret = <span class="hljs-string">""</span> <span class="hljs-keyword">Then</span> <span class="hljs-keyword">Exit</span> <span class="hljs-keyword">Do</span>
    ret = <span class="hljs-built_in">CDbl</span>(ret)
    msg(<span class="hljs-number">0</span>) = <span class="hljs-string">"MJD="</span> &#x26; ret
    msg(<span class="hljs-number">2</span>) = Julian<span class="hljs-built_in">Date</span>(ret)
    msg(<span class="hljs-number">4</span>) = Gregorian<span class="hljs-built_in">Date</span>(ret)
    Msgbox <span class="hljs-built_in">Join</span>(msg, vbCr)  <span class="hljs-comment">'配列をCR改行でつなげて表示</span>
<span class="hljs-keyword">Loop</span>



<span class="hljs-comment">'MJDからグレゴリオ暦の日付に変換して返す</span>
<span class="hljs-keyword">Function</span> Gregorian<span class="hljs-built_in">Date</span>(mjd)
    <span class="hljs-keyword">Dim</span> y, m, d

    <span class="hljs-comment">'MJDをグレゴリオ暦の西暦0年(紀元前1年)2月29日を第0日とした日数へ変換</span>
    d = mjd - (<span class="hljs-number">-678882</span>)
    y = <span class="hljs-number">0</span>
    m = <span class="hljs-number">3</span>

    <span class="hljs-keyword">Dim</span> arr1, arr2, arr3

    <span class="hljs-comment">'年の計算</span>
    arr1 = <span class="hljs-built_in">Array</span>(<span class="hljs-number">1</span>,<span class="hljs-number">365</span>,<span class="hljs-number">1461</span>,<span class="hljs-number">36524</span>,<span class="hljs-number">146097</span>)
    arr2 = <span class="hljs-built_in">Array</span>(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">100</span>,<span class="hljs-number">400</span>)
    arr3 = Div(d, arr1)
    y = y + Mult(arr2, arr3)
    d = arr3(<span class="hljs-number">0</span>)

    <span class="hljs-comment">'月の計算</span>
    <span class="hljs-comment">'2月末日の場合</span>
    <span class="hljs-keyword">If</span> d &#x3C; <span class="hljs-number">1</span> <span class="hljs-keyword">Then</span>
        m = <span class="hljs-number">2</span>
        <span class="hljs-keyword">If</span> arr3(<span class="hljs-number">1</span>) = <span class="hljs-number">0</span> <span class="hljs-keyword">And</span> (arr3(<span class="hljs-number">2</span>) &#x3C;> <span class="hljs-number">0</span> <span class="hljs-keyword">Or</span> arr3(<span class="hljs-number">3</span>) = <span class="hljs-number">0</span>)  <span class="hljs-keyword">Then</span>
            d = <span class="hljs-number">29</span> + d
        <span class="hljs-keyword">Else</span>
            d = <span class="hljs-number">28</span> + d
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    <span class="hljs-keyword">Else</span> <span class="hljs-comment">'2月末日以外の場合</span>
        <span class="hljs-keyword">Do</span> <span class="hljs-keyword">While</span> Month<span class="hljs-built_in">Day</span>(m) &#x3C; d
            m = m + <span class="hljs-number">1</span>
        <span class="hljs-keyword">Loop</span>
        d = d - Month<span class="hljs-built_in">Day</span>(m - <span class="hljs-number">1</span>)
        <span class="hljs-keyword">If</span> m > <span class="hljs-number">12</span> <span class="hljs-keyword">Then</span>
            y = y + <span class="hljs-number">1</span>
            m = m - <span class="hljs-number">12</span>
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    GregorianDate =  <span class="hljs-built_in">Join</span>(<span class="hljs-built_in">Array</span>(y,m,<span class="hljs-built_in">Round</span>(d, <span class="hljs-number">5</span>)), <span class="hljs-string">"/"</span>) <span class="hljs-comment">'日は小数点以下5桁まで</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>



<span class="hljs-comment">'MJDからユリウス暦の日付に変換して返す</span>
<span class="hljs-keyword">Function</span> Julian<span class="hljs-built_in">Date</span>(mjd)
    <span class="hljs-keyword">Dim</span> y, m, d

    <span class="hljs-comment">'MJDをユリウス暦の西暦0年(紀元前1年)2月29日を第0日とした日数へ変換</span>
    d = mjd - (<span class="hljs-number">-678884</span>)
    y = <span class="hljs-number">0</span>
    m = <span class="hljs-number">3</span>

    <span class="hljs-keyword">Dim</span> arr1, arr2, arr3

    <span class="hljs-comment">'年の計算</span>
    arr1 = <span class="hljs-built_in">Array</span>(<span class="hljs-number">1</span>,<span class="hljs-number">365</span>,<span class="hljs-number">1461</span>)
    arr2 = <span class="hljs-built_in">Array</span>(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">4</span>)
    arr3 = Div(d, arr1)
    y = y + Mult(arr2, arr3)
    d = arr3(<span class="hljs-number">0</span>)

    <span class="hljs-comment">'月の計算</span>
    <span class="hljs-comment">'2月末日の場合</span>
    <span class="hljs-keyword">If</span> d &#x3C; <span class="hljs-number">1</span> <span class="hljs-keyword">Then</span>
        m = <span class="hljs-number">2</span>
        <span class="hljs-keyword">If</span> arr3(<span class="hljs-number">1</span>) = <span class="hljs-number">0</span> <span class="hljs-keyword">Then</span>
            d = <span class="hljs-number">29</span> + d
        <span class="hljs-keyword">Else</span>
            d = <span class="hljs-number">28</span> + d
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    <span class="hljs-keyword">Else</span> <span class="hljs-comment">'2月末日以外の場合</span>
        <span class="hljs-keyword">Do</span> <span class="hljs-keyword">While</span> Month<span class="hljs-built_in">Day</span>(m) &#x3C; d
            m = m + <span class="hljs-number">1</span>
        <span class="hljs-keyword">Loop</span>
        d = d - Month<span class="hljs-built_in">Day</span>(m - <span class="hljs-number">1</span>)
        <span class="hljs-keyword">If</span> m > <span class="hljs-number">12</span> <span class="hljs-keyword">Then</span>
            y = y + <span class="hljs-number">1</span>
            m = m - <span class="hljs-number">12</span>
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    JulianDate =  <span class="hljs-built_in">Join</span>(<span class="hljs-built_in">Array</span>(y,m,<span class="hljs-built_in">Round</span>(d, <span class="hljs-number">5</span>)), <span class="hljs-string">"/"</span>) <span class="hljs-comment">'日は小数点以下5桁まで</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>



<span class="hljs-comment">'例えばarr=[1,365,1461]の場合、a(0)+365*a(1)+1461*a(2)=valとなる配列aを返す</span>
<span class="hljs-keyword">Function</span> Div(val, arr)
    <span class="hljs-keyword">Dim</span> iMax
    <span class="hljs-keyword">Dim</span> buf
    <span class="hljs-keyword">Dim</span> i

    iMax = <span class="hljs-built_in">UBound</span>(arr)
    <span class="hljs-keyword">ReDim</span> buf(iMax)
    buf(<span class="hljs-number">0</span>) = val
    <span class="hljs-keyword">For</span> i = iMax <span class="hljs-keyword">To</span> <span class="hljs-number">1</span> <span class="hljs-keyword">Step</span> <span class="hljs-number">-1</span>
        buf(i) = <span class="hljs-built_in">Int</span>(buf(<span class="hljs-number">0</span>) / arr(i))     <span class="hljs-comment">'商の整数部</span>
        buf(<span class="hljs-number">0</span>) = buf(<span class="hljs-number">0</span>) - arr(i) * buf(i) <span class="hljs-comment">'余り(>0)</span>
    <span class="hljs-keyword">Next</span>
    Div = buf
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>



<span class="hljs-comment">'2つの配列の「内積」を返す</span>
<span class="hljs-keyword">Function</span> Mult(arr1, arr2)
    <span class="hljs-keyword">Dim</span> i

    <span class="hljs-keyword">For</span> i = <span class="hljs-number">0</span> <span class="hljs-keyword">To</span> <span class="hljs-built_in">UBound</span>(arr1)
        Mult = Mult + arr1(i) * arr2(i)
    <span class="hljs-keyword">Next</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>



<span class="hljs-comment">'2月末日を第0日としてM月末日までの日数を返す(M=2～13)</span>
<span class="hljs-keyword">Function</span> Month<span class="hljs-built_in">Day</span>(M)
  MonthDay = <span class="hljs-built_in">Int</span>(<span class="hljs-number">30.59</span> * (M - <span class="hljs-number">1</span>)) - <span class="hljs-number">30</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>

</code></pre>
<h2 id="参考">参考</h2>
<ul>
<li><a href="https://ja.wikipedia.org/wiki/%E3%83%A6%E3%83%AA%E3%82%A6%E3%82%B9%E9%80%9A%E6%97%A5">ユリウス通日(Wikipedia)</a></li>
<li>マイコン宇宙講座―楽しい軌道計算プログラム(中野主一著)<br>
自分が購入したときは(2009年)送料込みで1,090円だったのですが、今Amazonを見ると滅茶苦茶高騰してました...。</li>
</ul></div></article></div></div></main></div><footer class="bg-neutral-50 border-t border-neutral-200 dark:bg-slate-800"><div class="container px-8"><div class="py-28 flex flex-col lg:flex-row items-center"><h3 class="text-4xl lg:text-[2.5rem] font-bold tracking-tighter leading-tight text-center lg:text-left mb-10 lg:mb-0 lg:pr-4 lg:w-1/2">Statically Generated with Next.js.</h3><div class="flex flex-col lg:flex-row justify-center items-center lg:pl-4 lg:w-1/2"><a href="https://nextjs.org/docs/app/building-your-application/routing/layouts-and-templates" class="mx-3 bg-black hover:bg-white hover:text-black border border-black text-white font-bold py-3 px-12 lg:px-8 duration-200 transition-colors mb-6 lg:mb-0">Read Documentation</a><a href="https://github.com/sammaya164/test" class="mx-3 font-bold hover:underline">View on GitHub</a></div></div></div></footer><script src="/test/_next/static/chunks/webpack-62f207c7777ca9db.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/test/_next/static/css/8579c4287a58b810.css\",\"style\"]\n2:HL[\"/test/_next/static/css/ce90c4206395b4a9.css\",\"style\"]\n3:HL[\"/test/_next/static/css/f8ca774482f3c2cc.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"4:I[2846,[],\"\"]\n7:I[4707,[],\"\"]\n9:I[6423,[],\"\"]\na:I[76,[\"185\",\"static/chunks/app/layout-b51a0ad6cf0fab32.js\"],\"ThemeSwitcher\"]\n10:I[1060,[],\"\"]\n8:[\"slug\",\"calender1\",\"d\"]\nb:{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"}\nc:{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"}\nd:{\"display\":\"inline-block\"}\ne:{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0}\n11:[]\n"])</script><script>self.__next_f.push([1,"0:[\"$\",\"$L4\",null,{\"buildId\":\"1AXbOSjeAIWogq940gTKm\",\"assetPrefix\":\"/test\",\"urlParts\":[\"\",\"calender1\"],\"initialTree\":[\"\",{\"children\":[\"(blog)\",{\"children\":[[\"slug\",\"calender1\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"calender1\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"(blog)\",{\"children\":[[\"slug\",\"calender1\",\"d\"],{\"children\":[\"__PAGE__\",{},[[\"$L5\",\"$L6\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/test/_next/static/css/f8ca774482f3c2cc.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]]],null],null]},[null,[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(blog)\",\"children\",\"$8\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/test/_next/static/css/ce90c4206395b4a9.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"main\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"container px-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"lg:flex py-2\",\"children\":[[\"$\",\"div\",null,{\"className\":\"sidebar overflow-x-visible lg:border-r lg:overflow-y-scroll py-4 min-w-80 lg:w-1/5\",\"children\":[\"$\",\"nav\",null,{\"children\":[[\"$\",\"input\",null,{\"id\":\"ac-toc\",\"type\":\"checkbox\",\"className\":\"peer/toc hidden\"}],[\"$\",\"label\",null,{\"htmlFor\":\"ac-toc\",\"className\":\"   accodiontoc mb-1   relative before:absolute after:absolute    z-10 after:z-11 before:z-12   peer-checked/toc:hover:after:-rotate-90   peer-checked/toc:bg-[#333]   peer-checked/toc:text-white   peer-checked/toc:before:bg-white   peer-checked/toc:after:bg-white   after:duration-300   py-2 pl-4 pr-10    text-xs font-bold   border border-solid rounded   border-white hover:border-[#bdc1c4]   inline-block   text-[#7a8288] hover:text-white   hover:bg-[#333]   before:content-[''] after:content-['']   before:w-2.5 before:h-0.5 after:w-0.5 after:h-2.5   before:right-4 before:top-4 after:right-5  after:top-3   before:bg-[#7a8288] after:bg-[#7a8288]   hover:after:bg-white hover:before:bg-white   lg:hidden   \",\"children\":\"メニュー\"}],[\"$\",\"div\",null,{\"className\":\"hidden lg:block peer-checked/toc:block mt-8 lg:mt-4\",\"children\":[\"$\",\"section\",null,{\"children\":[[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/helloworld\",\"className\":\"hover:underline\",\"children\":\"Hello, World!と表示させる\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/msgbox\",\"className\":\"hover:underline\",\"children\":\"MsgBox関数\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/inputbox\",\"className\":\"hover:underline\",\"children\":\"InputBox関数\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/array\",\"className\":\"hover:underline\",\"children\":\"配列(1) 配列の作り方\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/filter\",\"className\":\"hover:underline\",\"children\":\"配列(2) 配列の操作\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/rename\",\"className\":\"hover:underline\",\"children\":\"ファイル名の頭に日付を加える\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/fso\",\"className\":\"hover:underline\",\"children\":\"FileSystemObjectオブジェクト\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/path\",\"className\":\"hover:underline\",\"children\":\"ファイル名、パス名を取得する\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/file\",\"className\":\"hover:underline\",\"children\":\"File、Folder、Driveオブジェクト\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/filelist\",\"className\":\"hover:underline\",\"children\":\"ファイル一覧を取得する\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/textstream\",\"className\":\"hover:underline\",\"children\":\"TextStreamオブジェクト\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/mdb1\",\"className\":\"hover:underline\",\"children\":\"Access形式データベースへの接続（1）\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/mdb2\",\"className\":\"hover:underline\",\"children\":\"Access形式データベースへの接続（2）\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/stream\",\"className\":\"hover:underline\",\"children\":\"Streamオブジェクト\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/adox\",\"className\":\"hover:underline\",\"children\":\"ADOXの説明\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/mnist\",\"className\":\"hover:underline\",\"children\":\"バイナリファイルを読む\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/fldtype\",\"className\":\"hover:underline\",\"children\":\"ADOのデータ型\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/class\",\"className\":\"hover:underline\",\"children\":\"クラスを自作する\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/calender1\",\"className\":\"hover:underline\",\"children\":\"カレンダー計算(1) \"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/encoder\",\"className\":\"hover:underline\",\"children\":\"VBScriptの暗号化\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/test/calender2\",\"className\":\"hover:underline\",\"children\":\"カレンダー計算(2) \"}]}]}]]}]}]]}]}],[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(blog)\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[]}]]}]}]}]],null],null]},[[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/test/_next/static/css/8579c4287a58b810.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"apple-touch-icon\",\"sizes\":\"180x180\",\"href\":\"/test/favicon/apple-touch-icon.png\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"sizes\":\"32x32\",\"href\":\"/test/favicon/favicon-32x32.png\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"sizes\":\"16x16\",\"href\":\"/test/favicon/favicon-16x16.png\"}],[\"$\",\"link\",null,{\"rel\":\"manifest\",\"href\":\"/test/favicon/site.webmanifest\"}],[\"$\",\"link\",null,{\"rel\":\"mask-icon\",\"href\":\"/test/favicon/safari-pinned-tab.svg\",\"color\":\"#000000\"}],[\"$\",\"link\",null,{\"rel\":\"shortcut icon\",\"href\":\"/test/favicon/favicon.ico\"}],[\"$\",\"meta\",null,{\"name\":\"msapplication-TileColor\",\"content\":\"#000000\"}],[\"$\",\"meta\",null,{\"name\":\"msapplication-config\",\"content\":\"/test/favicon/browserconfig.xml\"}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"content\":\"#000\"}],[\"$\",\"link\",null,{\"rel\":\"alternate\",\"type\":\"application/rss+xml\",\"href\":\"/test/feed.xml\"}]]}],[\"$\",\"body\",null,{\"className\":\"__className_d8d0ad dark:bg-slate-900 dark:text-slate-400\",\"children\":[[\"$\",\"$La\",null,{}],[\"$\",\"header\",null,{\"className\":\"border-b border-neutral-200 dark:bg-stars\",\"children\":[\"$\",\"div\",null,{\"className\":\"container px-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"py-16 flex flex-col lg:flex-row items-center\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"text-2xl lg:text-4xl font-bold tracking-tight lg:tracking-tighter leading-tight lg:w-1/3\",\"children\":[[\"$\",\"a\",null,{\"href\":\"/test\",\"className\":\"hover:underline\",\"children\":\"VBScriptさんま屋\"}],\".\"]}],[\"$\",\"h4\",null,{\"className\":\"text-center text-lg\",\"children\":\"VBScriptの個人的なメモです (´・ω・`)\"}]]}]}]}],[\"$\",\"div\",null,{\"className\":\"min-h-1/2\",\"children\":[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":\"$b\",\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":\"$c\",\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":\"$d\",\"children\":[\"$\",\"h2\",null,{\"style\":\"$e\",\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[]}]}],[\"$\",\"footer\",null,{\"className\":\"bg-neutral-50 border-t border-neutral-200 dark:bg-slate-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"container px-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"py-28 flex flex-col lg:flex-row items-center\",\"children\":[[\"$\",\"h3\",null,{\"className\":\"text-4xl lg:text-[2.5rem] font-bold tracking-tighter leading-tight text-center lg:text-left mb-10 lg:mb-0 lg:pr-4 lg:w-1/2\",\"children\":\"Statically Generated with Next.js.\"}],[\"$\",\"div\",null,{\"className\":\"flex flex-col lg:flex-row justify-center items-center lg:pl-4 lg:w-1/2\",\"children\":[[\"$\",\"a\",null,{\"href\":\"https://nextjs.org/docs/app/building-your-application/routing/layouts-and-templates\",\"className\":\"mx-3 bg-black hover:bg-white hover:text-black border border-black text-white font-bold py-3 px-12 lg:px-8 duration-200 transition-colors mb-6 lg:mb-0\",\"children\":\"Read Documentation\"}],[\"$\",\"a\",null,{\"href\":\"https://github.com/sammaya164/test\",\"className\":\"mx-3 font-bold hover:underline\",\"children\":\"View on GitHub\"}]]}]]}]}]}]]}]]}]],null],null],\"couldBeIntercepted\":false,\"initialHead\":[null,\"$Lf\"],\"globalErrorComponent\":\"$10\",\"missingSlots\":\"$W11\"}]\n"])</script><script>self.__next_f.push([1,"12:T5ec3,"])</script><script>self.__next_f.push([1,"\u003cnav class=\"toc\"\u003e\u003col class=\"toc-level toc-level-1\"\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#日付を日数で表す\"\u003e日付を日数で表す\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#西暦\"\u003e西暦\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#ユリウス日修正ユリウス日を計算する\"\u003eユリウス日、修正ユリウス日を計算する\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#修正ユリウス日から日付へ変換する\"\u003e修正ユリウス日から日付へ変換する\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#参考\"\u003e参考\u003c/a\u003e\u003c/li\u003e\u003c/ol\u003e\u003c/nav\u003e\u003ch2 id=\"日付を日数で表す\"\u003e日付を日数で表す\u003c/h2\u003e\n\u003cp\u003e年月日で表される日付は、いわば年・月・日の3つの軸をもつ空間に並べられた\u003cbr\u003e\n点の集まりと解釈できます。\u003cbr\u003e\nしかし天文計算においては、日付は1本の線上に並べたほうが扱い易くなります。\u003cbr\u003e\nすなわち、ある特定の日を第0日としたときの通算の日数で日付を表すという方法です。\u003c/p\u003e\n\u003ch3 id=\"ユリウス日julian-day\"\u003eユリウス日(Julian Day)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eユリウス日(ユリウス通日、JD)は、紀元前4713年1月1日正午(ユリウス暦)を第0日としたときの通算の日数で日付を表したものです。\u003c/li\u003e\n\u003cli\u003e正負の整数であれば正午を表しますが、小数部で時刻を表します。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e2023年1月1日の正午で、2,459,946になります。\u003cbr\u003e\n{: .notice--info}\u003c/p\u003e\n\u003ch3 id=\"修正ユリウス日modified-julian-day\"\u003e修正ユリウス日(Modified Julian Day)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e修正ユリウス日(準ユリウス日、MJD)は、ユリウス日よりも小さい桁で日付を扱えるよう考え出され、ユリウス日から2400000.5日を引いたものとして定義されます。\u003c/li\u003e\n\u003cli\u003e1858年11月17日(グレゴリオ暦)を第0日としたときの通算の日数で日付を表します。\u003c/li\u003e\n\u003cli\u003e正負の整数であれば午前0時を表しますが、小数部で時刻を表します。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e2023年1月1日の午前0時で59,945になります。\u003cbr\u003e\n{: .notice--info}\u003c/p\u003e\n\u003ch2 id=\"西暦\"\u003e西暦\u003c/h2\u003e\n\u003cp\u003e西暦には、うるう年をどのように定めるかによって、ユリウス暦とグレゴリオ暦があります。\u003cbr\u003e\n現在使われているのはグレゴリオ暦です。\u003c/p\u003e\n\u003ch3 id=\"ユリウス暦\"\u003eユリウス暦\u003c/h3\u003e\n\u003cp\u003e以下のルールがあります。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eうるう年は4年に1回。\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eすなわち4年は正確に1,461日(=365×3+366)、1年あたりは365.25日(=1,461/4)。\u003c/p\u003e\n\u003cp\u003e実際の1太陽年はおよそ365.2422日なので「春分、夏至、秋分、冬至」といった季節の移り変わりに対し、\u003cbr\u003e\n1年あたり-0.0078日(=365.2422-365.25)の誤差が生じます。1600年経てば約12.5日のズレになります。\u003c/p\u003e\n\u003cp\u003eユリウス暦は紀元前45年にローマで導入されましたが、当初は4年に1回とすべきうるう年を、3年に1回で誤運用してしまいました。\u003cbr\u003e\n誤りに気づいた後、調整の為うるう年を設けない期間が設けられ、西暦8年のうるう年以降は4年に1回で運用されました。\u003cbr\u003e\n以下のプログラムにおけるユリウス暦の計算では、このへんの歴史は考慮せず、単純に4年に1回うるう年を設けています。\u003cbr\u003e\n{: .notice--info}\u003c/p\u003e\n\u003ch3 id=\"グレゴリオ暦\"\u003eグレゴリオ暦\u003c/h3\u003e\n\u003cp\u003e以下のルールがあります。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eうるう年は4年に1回\u003c/li\u003e\n\u003cli\u003eただし100年に1回(西暦が100で割り切れる年)はうるう年を取消し。\u003c/li\u003e\n\u003cli\u003eただし400年に1回(西暦が400で割り切れる年)はやっぱりうるう年。\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eすなわち400年は正確に146,097日(=365×303+366×97)、1年あたりは365.2425日(=146,097/400)。\u003c/p\u003e\n\u003cp\u003e期間の選び方によって、4年は1,460日の場合と1,461日の場合があり、100年は36,524日の場合と36,525日の場合があります。\u003cbr\u003e\n{: .notice--info}\u003c/p\u003e\n\u003cp\u003eグレゴリオ暦は、ユリウス暦1582年10月4日の翌日、グレゴリオ暦1582年10月15日からローマで採用されました。\u003cbr\u003e\nグレゴリオ暦の導入時期は国によって異なり、日本では旧暦明治5年12月2日の翌日、新暦明治6年1月1日から開始されました。\u003c/p\u003e\n\u003cp\u003e季節の移り変わりに対し、1年あたり約+0.0003日の誤差が生じます。\u003cbr\u003e\n1万年経っても約3日のズレしかない計算になります。\u003c/p\u003e\n\u003cp\u003eなお地球の自転や公転のスピードは徐々に変動している為、それらの比である1太陽年の日数も変動します。\u003cbr\u003e\n1万年後のズレは3日より小さいかも知れないし、大きいかも知れません。\u003cbr\u003e\n{: .notice--info}\u003c/p\u003e\n\u003ch3 id=\"紀元前の表現\"\u003e紀元前の表現\u003c/h3\u003e\n\u003cp\u003e西暦1年の前年は紀元前1年ですが、天文学では年数計算を簡便にする為、紀元前1年を西暦0年、\u003cbr\u003e\n紀元前2年を西暦-1年、・・、紀元前N年を西暦-(N-1)年とする紀年法が使われるそうです。\u003cbr\u003e\n以下のプログラムもこれに従います。たとえば紀元前4713年は西暦-4712年になります。\u003c/p\u003e\n\u003ch2 id=\"ユリウス日修正ユリウス日を計算する\"\u003eユリウス日、修正ユリウス日を計算する\u003c/h2\u003e\n\u003cp\u003e年月日からユリウス日、修正ユリウス日を算出して表示するプログラムです。重要なのは\u003ccode\u003eDateToMJD\u003c/code\u003e関数の箇所です。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-vbs\"\u003e\u003cspan class=\"hljs-comment\"\u003e'ユリウス日、修正ユリウス日を計算する\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e ret\n\u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e dt \u003cspan class=\"hljs-comment\"\u003e'年月日を表す配列\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e buf(\u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e)\n\u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e mjd\n\n\u003cspan class=\"hljs-keyword\"\u003eDo\u003c/span\u003e\n    ret = \u003cspan class=\"hljs-built_in\"\u003eInputBox\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"日付を入力して下さい\"\u003c/span\u003e, , \u003cspan class=\"hljs-built_in\"\u003eDate\u003c/span\u003e())\n    \u003cspan class=\"hljs-keyword\"\u003eIf\u003c/span\u003e ret = \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eThen\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eExit\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eDo\u003c/span\u003e\n    dt = \u003cspan class=\"hljs-built_in\"\u003eSplit\u003c/span\u003e(ret, \u003cspan class=\"hljs-string\"\u003e\"/\"\u003c/span\u003e) \u003cspan class=\"hljs-comment\"\u003e'Splitで取得した配列要素は文字列\u003c/span\u003e\n    dt = ToNumeric(dt)   \u003cspan class=\"hljs-comment\"\u003e'配列要素を数値へ変換\u003c/span\u003e\n\n    mjd = DateToMJD(dt(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e), dt(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e), dt(\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e), \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n    buf(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) = \u003cspan class=\"hljs-string\"\u003e\"ユリウス暦の\"\u003c/span\u003e \u0026#x26; ret \u0026#x26; \u003cspan class=\"hljs-string\"\u003e\"は\"\u003c/span\u003e\n    buf(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) = \u003cspan class=\"hljs-string\"\u003e\"JD=\"\u003c/span\u003e \u0026#x26; mjd + \u003cspan class=\"hljs-number\"\u003e2400000.5\u003c/span\u003e\n    buf(\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e) = \u003cspan class=\"hljs-string\"\u003e\"MJD=\"\u003c/span\u003e \u0026#x26; mjd\n\n    mjd = DateToMJD(dt(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e), dt(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e), dt(\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e), \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)\n    buf(\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e) = \u003cspan class=\"hljs-string\"\u003e\"グレゴリオ暦の\"\u003c/span\u003e \u0026#x26; ret \u0026#x26; \u003cspan class=\"hljs-string\"\u003e\"は\"\u003c/span\u003e\n    buf(\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e) = \u003cspan class=\"hljs-string\"\u003e\"JD=\"\u003c/span\u003e \u0026#x26; mjd + \u003cspan class=\"hljs-number\"\u003e2400000.5\u003c/span\u003e\n    buf(\u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e) = \u003cspan class=\"hljs-string\"\u003e\"MJD=\"\u003c/span\u003e \u0026#x26; mjd\n\n    Msgbox \u003cspan class=\"hljs-built_in\"\u003eJoin\u003c/span\u003e(buf, vbCr),, \u003cspan class=\"hljs-string\"\u003e\"ユリウス日計算\"\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e'配列をCR改行でつなげて表示\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eLoop\u003c/span\u003e\n\n\n\n\u003cspan class=\"hljs-comment\"\u003e'配列の要素を数値へ変換する\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eFunction\u003c/span\u003e ToNumeric(\u003cspan class=\"hljs-keyword\"\u003eByVal\u003c/span\u003e arr)\n    \u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e i\n\n    \u003cspan class=\"hljs-keyword\"\u003eFor\u003c/span\u003e i = \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eTo\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eUBound\u003c/span\u003e(arr)\n        \u003cspan class=\"hljs-keyword\"\u003eIf\u003c/span\u003e I\u003cspan class=\"hljs-built_in\"\u003esNumeric\u003c/span\u003e(arr(i)) \u003cspan class=\"hljs-keyword\"\u003eThen\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e'数値として解釈できるなら\u003c/span\u003e\n            arr(i) = \u003cspan class=\"hljs-built_in\"\u003eCDbl\u003c/span\u003e(arr(i)) \u003cspan class=\"hljs-comment\"\u003e'Double型へ変換\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eEnd\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eIf\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eNext\u003c/span\u003e\n    ToNumeric = arr\n\u003cspan class=\"hljs-keyword\"\u003eEnd\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eFunction\u003c/span\u003e\n\n\n\n\u003cspan class=\"hljs-comment\"\u003e'修正ユリウス日を算出\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e'intCalender:暦を指定 (1:ユリウス暦, 2:グレゴリオ暦)\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eFunction\u003c/span\u003e DateToMJD(\u003cspan class=\"hljs-keyword\"\u003eByVal\u003c/span\u003e Y, \u003cspan class=\"hljs-keyword\"\u003eByVal\u003c/span\u003e M, \u003cspan class=\"hljs-keyword\"\u003eByVal\u003c/span\u003e D, intCalender)\n    \u003cspan class=\"hljs-comment\"\u003e'1,2月を前年の13,14月にする\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eIf\u003c/span\u003e M \u0026#x3C; \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eThen\u003c/span\u003e\n        Y = Y - \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n        M = M + \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eEnd\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eIf\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e'暦に応じて日付から修正ユリウス日を算出\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eSelect\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eCase\u003c/span\u003e intCalender\n    \u003cspan class=\"hljs-keyword\"\u003eCase\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n        DateToMJD = - \u003cspan class=\"hljs-number\"\u003e678884\u003c/span\u003e + \u003cspan class=\"hljs-number\"\u003e365\u003c/span\u003e * Y + Month\u003cspan class=\"hljs-built_in\"\u003eDay\u003c/span\u003e(M - \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) + D + \u003cspan class=\"hljs-built_in\"\u003eInt\u003c/span\u003e(Y / \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e)\n    \u003cspan class=\"hljs-keyword\"\u003eCase\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\n        DateToMJD = - \u003cspan class=\"hljs-number\"\u003e678882\u003c/span\u003e + \u003cspan class=\"hljs-number\"\u003e365\u003c/span\u003e * Y + Month\u003cspan class=\"hljs-built_in\"\u003eDay\u003c/span\u003e(M - \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) + D + \u003cspan class=\"hljs-built_in\"\u003eInt\u003c/span\u003e(Y / \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e) - \u003cspan class=\"hljs-built_in\"\u003eInt\u003c/span\u003e(Y / \u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e) + \u003cspan class=\"hljs-built_in\"\u003eInt\u003c/span\u003e(Y / \u003cspan class=\"hljs-number\"\u003e400\u003c/span\u003e)\n    \u003cspan class=\"hljs-keyword\"\u003eEnd\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eSelect\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eEnd\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eFunction\u003c/span\u003e\n\n\n\n\u003cspan class=\"hljs-comment\"\u003e' 2月末日を第0日としてM月末日までの日数を返す(M=2～13)\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eFunction\u003c/span\u003e Month\u003cspan class=\"hljs-built_in\"\u003eDay\u003c/span\u003e(M)\n    MonthDay = \u003cspan class=\"hljs-built_in\"\u003eInt\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e30.59\u003c/span\u003e * (M - \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)) - \u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eEnd\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eFunction\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eByVal:\u003c/strong\u003e VBScriptでは引数はデフォルトで参照渡しですが、ByValをつけることで値渡しになります。\u003c/p\u003e\n\u003cp\u003e1,2月を13,14月に変換するのは、計算上2月末日を1年の最終日、もしくは翌年の第0日として扱うためです。\u003c/p\u003e\n\u003cp\u003eMJDの計算式に出てくる-678884と-678882は、それぞれユリウス暦とグレゴリオ暦における紀元前1年2月29日のMJDです。\u003c/p\u003e\n\u003cp\u003e上記のMonthDay関数の引数と戻り値は次表のようになります。\u003c/p\u003e\n\u003cp\u003e|引数|2|3|4|5|6|7|8|9|10|11|12|13|\u003cbr\u003e\n|---|---|---|---|---|---|---|\u003cbr\u003e\n|戻り値|0|31|61|92|122|153|184|214|245|275|306|337|\u003c/p\u003e\n\u003cp\u003e次のように書いたほうが、何をやっているかはわかりやすいかも知れません。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-vbs\"\u003e\u003cspan class=\"hljs-comment\"\u003e' 2月末日を第0日としてM月末日までの日数を返す(M=2～13)\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eFunction\u003c/span\u003e Month\u003cspan class=\"hljs-built_in\"\u003eDay\u003c/span\u003e(M)\n    \u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e days(\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e)\n    \u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e i\n    \n    days(\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e)  = \u003cspan class=\"hljs-number\"\u003e31\u003c/span\u003e\n    days(\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e)  = \u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e\n    days(\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e)  = \u003cspan class=\"hljs-number\"\u003e31\u003c/span\u003e\n    days(\u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e)  = \u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e\n    days(\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e)  = \u003cspan class=\"hljs-number\"\u003e31\u003c/span\u003e\n    days(\u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e)  = \u003cspan class=\"hljs-number\"\u003e31\u003c/span\u003e\n    days(\u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e)  = \u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e\n    days(\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e) = \u003cspan class=\"hljs-number\"\u003e31\u003c/span\u003e\n    days(\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e) = \u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e\n    days(\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e) = \u003cspan class=\"hljs-number\"\u003e31\u003c/span\u003e\n    days(\u003cspan class=\"hljs-number\"\u003e13\u003c/span\u003e) = \u003cspan class=\"hljs-number\"\u003e31\u003c/span\u003e\n    \n    \u003cspan class=\"hljs-keyword\"\u003eFor\u003c/span\u003e i = \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eTo\u003c/span\u003e M\n        MonthDay = MonthDay + days(i)\n    \u003cspan class=\"hljs-keyword\"\u003eNext\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eEnd\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eFunction\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"修正ユリウス日から日付へ変換する\"\u003e修正ユリウス日から日付へ変換する\u003c/h2\u003e\n\u003cp\u003e日付への変換は、その逆より難しいです。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-vbs\"\u003e\u003cspan class=\"hljs-comment\"\u003e'MJDから日付へ変換して表示する\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e ret\n\u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e msg(\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e)\nmsg(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) = \u003cspan class=\"hljs-string\"\u003e\"ユリウス暦:\"\u003c/span\u003e\nmsg(\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e) = \u003cspan class=\"hljs-string\"\u003e\"グレゴリオ暦:\"\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003eDo\u003c/span\u003e\n    ret = \u003cspan class=\"hljs-built_in\"\u003eInputBox\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"MJDを入力してください。\"\u003c/span\u003e)\n    \u003cspan class=\"hljs-keyword\"\u003eIf\u003c/span\u003e ret = \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eThen\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eExit\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eDo\u003c/span\u003e\n    ret = \u003cspan class=\"hljs-built_in\"\u003eCDbl\u003c/span\u003e(ret)\n    msg(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) = \u003cspan class=\"hljs-string\"\u003e\"MJD=\"\u003c/span\u003e \u0026#x26; ret\n    msg(\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e) = Julian\u003cspan class=\"hljs-built_in\"\u003eDate\u003c/span\u003e(ret)\n    msg(\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e) = Gregorian\u003cspan class=\"hljs-built_in\"\u003eDate\u003c/span\u003e(ret)\n    Msgbox \u003cspan class=\"hljs-built_in\"\u003eJoin\u003c/span\u003e(msg, vbCr)  \u003cspan class=\"hljs-comment\"\u003e'配列をCR改行でつなげて表示\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eLoop\u003c/span\u003e\n\n\n\n\u003cspan class=\"hljs-comment\"\u003e'MJDからグレゴリオ暦の日付に変換して返す\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eFunction\u003c/span\u003e Gregorian\u003cspan class=\"hljs-built_in\"\u003eDate\u003c/span\u003e(mjd)\n    \u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e y, m, d\n\n    \u003cspan class=\"hljs-comment\"\u003e'MJDをグレゴリオ暦の西暦0年(紀元前1年)2月29日を第0日とした日数へ変換\u003c/span\u003e\n    d = mjd - (\u003cspan class=\"hljs-number\"\u003e-678882\u003c/span\u003e)\n    y = \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n    m = \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e\n\n    \u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e arr1, arr2, arr3\n\n    \u003cspan class=\"hljs-comment\"\u003e'年の計算\u003c/span\u003e\n    arr1 = \u003cspan class=\"hljs-built_in\"\u003eArray\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e365\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e1461\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e36524\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e146097\u003c/span\u003e)\n    arr2 = \u003cspan class=\"hljs-built_in\"\u003eArray\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e400\u003c/span\u003e)\n    arr3 = Div(d, arr1)\n    y = y + Mult(arr2, arr3)\n    d = arr3(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n\n    \u003cspan class=\"hljs-comment\"\u003e'月の計算\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e'2月末日の場合\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eIf\u003c/span\u003e d \u0026#x3C; \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eThen\u003c/span\u003e\n        m = \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eIf\u003c/span\u003e arr3(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) = \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eAnd\u003c/span\u003e (arr3(\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e) \u0026#x3C;\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eOr\u003c/span\u003e arr3(\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e) = \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)  \u003cspan class=\"hljs-keyword\"\u003eThen\u003c/span\u003e\n            d = \u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e + d\n        \u003cspan class=\"hljs-keyword\"\u003eElse\u003c/span\u003e\n            d = \u003cspan class=\"hljs-number\"\u003e28\u003c/span\u003e + d\n        \u003cspan class=\"hljs-keyword\"\u003eEnd\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eIf\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eElse\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e'2月末日以外の場合\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eDo\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eWhile\u003c/span\u003e Month\u003cspan class=\"hljs-built_in\"\u003eDay\u003c/span\u003e(m) \u0026#x3C; d\n            m = m + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eLoop\u003c/span\u003e\n        d = d - Month\u003cspan class=\"hljs-built_in\"\u003eDay\u003c/span\u003e(m - \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n        \u003cspan class=\"hljs-keyword\"\u003eIf\u003c/span\u003e m \u003e \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eThen\u003c/span\u003e\n            y = y + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n            m = m - \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eEnd\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eIf\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eEnd\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eIf\u003c/span\u003e\n    GregorianDate =  \u003cspan class=\"hljs-built_in\"\u003eJoin\u003c/span\u003e(\u003cspan class=\"hljs-built_in\"\u003eArray\u003c/span\u003e(y,m,\u003cspan class=\"hljs-built_in\"\u003eRound\u003c/span\u003e(d, \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e)), \u003cspan class=\"hljs-string\"\u003e\"/\"\u003c/span\u003e) \u003cspan class=\"hljs-comment\"\u003e'日は小数点以下5桁まで\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eEnd\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eFunction\u003c/span\u003e\n\n\n\n\u003cspan class=\"hljs-comment\"\u003e'MJDからユリウス暦の日付に変換して返す\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eFunction\u003c/span\u003e Julian\u003cspan class=\"hljs-built_in\"\u003eDate\u003c/span\u003e(mjd)\n    \u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e y, m, d\n\n    \u003cspan class=\"hljs-comment\"\u003e'MJDをユリウス暦の西暦0年(紀元前1年)2月29日を第0日とした日数へ変換\u003c/span\u003e\n    d = mjd - (\u003cspan class=\"hljs-number\"\u003e-678884\u003c/span\u003e)\n    y = \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n    m = \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e\n\n    \u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e arr1, arr2, arr3\n\n    \u003cspan class=\"hljs-comment\"\u003e'年の計算\u003c/span\u003e\n    arr1 = \u003cspan class=\"hljs-built_in\"\u003eArray\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e365\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e1461\u003c/span\u003e)\n    arr2 = \u003cspan class=\"hljs-built_in\"\u003eArray\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e)\n    arr3 = Div(d, arr1)\n    y = y + Mult(arr2, arr3)\n    d = arr3(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n\n    \u003cspan class=\"hljs-comment\"\u003e'月の計算\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e'2月末日の場合\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eIf\u003c/span\u003e d \u0026#x3C; \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eThen\u003c/span\u003e\n        m = \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eIf\u003c/span\u003e arr3(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) = \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eThen\u003c/span\u003e\n            d = \u003cspan class=\"hljs-number\"\u003e29\u003c/span\u003e + d\n        \u003cspan class=\"hljs-keyword\"\u003eElse\u003c/span\u003e\n            d = \u003cspan class=\"hljs-number\"\u003e28\u003c/span\u003e + d\n        \u003cspan class=\"hljs-keyword\"\u003eEnd\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eIf\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eElse\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e'2月末日以外の場合\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eDo\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eWhile\u003c/span\u003e Month\u003cspan class=\"hljs-built_in\"\u003eDay\u003c/span\u003e(m) \u0026#x3C; d\n            m = m + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eLoop\u003c/span\u003e\n        d = d - Month\u003cspan class=\"hljs-built_in\"\u003eDay\u003c/span\u003e(m - \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n        \u003cspan class=\"hljs-keyword\"\u003eIf\u003c/span\u003e m \u003e \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eThen\u003c/span\u003e\n            y = y + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n            m = m - \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eEnd\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eIf\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eEnd\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eIf\u003c/span\u003e\n    JulianDate =  \u003cspan class=\"hljs-built_in\"\u003eJoin\u003c/span\u003e(\u003cspan class=\"hljs-built_in\"\u003eArray\u003c/span\u003e(y,m,\u003cspan class=\"hljs-built_in\"\u003eRound\u003c/span\u003e(d, \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e)), \u003cspan class=\"hljs-string\"\u003e\"/\"\u003c/span\u003e) \u003cspan class=\"hljs-comment\"\u003e'日は小数点以下5桁まで\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eEnd\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eFunction\u003c/span\u003e\n\n\n\n\u003cspan class=\"hljs-comment\"\u003e'例えばarr=[1,365,1461]の場合、a(0)+365*a(1)+1461*a(2)=valとなる配列aを返す\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eFunction\u003c/span\u003e Div(val, arr)\n    \u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e iMax\n    \u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e buf\n    \u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e i\n\n    iMax = \u003cspan class=\"hljs-built_in\"\u003eUBound\u003c/span\u003e(arr)\n    \u003cspan class=\"hljs-keyword\"\u003eReDim\u003c/span\u003e buf(iMax)\n    buf(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) = val\n    \u003cspan class=\"hljs-keyword\"\u003eFor\u003c/span\u003e i = iMax \u003cspan class=\"hljs-keyword\"\u003eTo\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eStep\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e-1\u003c/span\u003e\n        buf(i) = \u003cspan class=\"hljs-built_in\"\u003eInt\u003c/span\u003e(buf(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) / arr(i))     \u003cspan class=\"hljs-comment\"\u003e'商の整数部\u003c/span\u003e\n        buf(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) = buf(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) - arr(i) * buf(i) \u003cspan class=\"hljs-comment\"\u003e'余り(\u003e0)\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eNext\u003c/span\u003e\n    Div = buf\n\u003cspan class=\"hljs-keyword\"\u003eEnd\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eFunction\u003c/span\u003e\n\n\n\n\u003cspan class=\"hljs-comment\"\u003e'2つの配列の「内積」を返す\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eFunction\u003c/span\u003e Mult(arr1, arr2)\n    \u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e i\n\n    \u003cspan class=\"hljs-keyword\"\u003eFor\u003c/span\u003e i = \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eTo\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eUBound\u003c/span\u003e(arr1)\n        Mult = Mult + arr1(i) * arr2(i)\n    \u003cspan class=\"hljs-keyword\"\u003eNext\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eEnd\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eFunction\u003c/span\u003e\n\n\n\n\u003cspan class=\"hljs-comment\"\u003e'2月末日を第0日としてM月末日までの日数を返す(M=2～13)\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eFunction\u003c/span\u003e Month\u003cspan class=\"hljs-built_in\"\u003eDay\u003c/span\u003e(M)\n  MonthDay = \u003cspan class=\"hljs-built_in\"\u003eInt\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e30.59\u003c/span\u003e * (M - \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)) - \u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eEnd\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eFunction\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"参考\"\u003e参考\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://ja.wikipedia.org/wiki/%E3%83%A6%E3%83%AA%E3%82%A6%E3%82%B9%E9%80%9A%E6%97%A5\"\u003eユリウス通日(Wikipedia)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eマイコン宇宙講座―楽しい軌道計算プログラム(中野主一著)\u003cbr\u003e\n自分が購入したときは(2009年)送料込みで1,090円だったのですが、今Amazonを見ると滅茶苦茶高騰してました...。\u003c/li\u003e\n\u003c/ul\u003e"])</script><script>self.__next_f.push([1,"6:[\"$\",\"article\",null,{\"className\":\"mb-32 pt-6 lg:px-6\",\"children\":[[[\"$\",\"h1\",null,{\"className\":\"text-5xl md:text-7xl lg:text-8xl font-bold tracking-tighter leading-tight md:leading-none mb-12 text-left\",\"children\":\"カレンダー計算(1) \"}],[\"$\",\"div\",null,{\"className\":\"mb-6 text-lg\",\"children\":[\"$\",\"time\",null,{\"dateTime\":\"2024-10-31T00:00:00.000Z\",\"children\":\"2024/10/31\"}]}]],[\"$\",\"div\",null,{\"className\":\"markdown-styles_markdown__ORfR8\",\"dangerouslySetInnerHTML\":{\"__html\":\"$12\"}}]]}]\nf:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"カレンダー計算(1)  | VBScriptさんま屋\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"VBScriptの個人的なメモです\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:title\",\"content\":\"カレンダー計算(1) \"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:description\",\"content\":\"VBScriptの個人的なメモです\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:image\",\"content\":\"https://www.sammaya.jp/test/assets/img/stars.jpg\"}],[\"$\",\"meta\",\"7\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"8\",{\"name\":\"twitter:title\",\"content\":\"カレンダー計算(1) \"}],[\"$\",\"meta\",\"9\",{\"name\":\"twitter:description\",\"content\":\"VBScriptの個人的なメモです\"}],[\"$\",\"meta\",\"10\",{\"name\":\"twitter:image\",\"content\":\"https://www.sammaya.jp/test/assets/img/stars.jpg\"}]]\n5:null\n"])</script></body></html>